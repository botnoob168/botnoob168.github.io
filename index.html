<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wheel of Names</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Prompt', sans-serif;
    }
    .wheel-container {
      filter: drop-shadow(0 10px 30px rgba(0,0,0,0.3));
    }
    @keyframes confetti {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100px) rotate(720deg); opacity: 0; }
    }
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      animation: confetti 1s ease-out forwards;
    }
    .glow-pulse {
      animation: glowPulse 2s ease-in-out infinite;
    }
    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.5); }
      50% { box-shadow: 0 0 40px rgba(255,215,0,0.8); }
    }
    .name-item:hover {
      transform: translateX(5px);
    }
    .locked-indicator {
      background: linear-gradient(135deg, #ffd700, #ff8c00);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-auto">
  <div id="app-wrapper" class="min-h-full w-full bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 p-4 md:p-8"><!-- Header -->
   <div class="text-center mb-6">
    <h1 id="wheel-title" class="text-3xl md:text-4xl font-bold text-white mb-2">üéØ ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠</h1>
    <p class="text-purple-200 text-sm">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠ ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!</p>
   </div>
   <div class="max-w-6xl mx-auto flex flex-col lg:flex-row gap-6"><!-- Left Panel - Names List -->
    <div class="w-full lg:w-80 bg-white/10 backdrop-blur-lg rounded-2xl p-4 border border-white/20">
     <h2 class="text-white font-semibold mb-3 flex items-center gap-2"><span>üìù</span> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (<span id="name-count">0</span>)</h2><!-- Add Name Input -->
     <div class="flex gap-2 mb-4"><input type="text" id="name-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠..." class="flex-1 px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/50 border border-white/30 focus:outline-none focus:border-yellow-400 text-sm"> <button id="add-btn" class="px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition-all text-sm"> ‡πÄ‡∏û‡∏¥‡πà‡∏° </button>
     </div><!-- Names List -->
     <div id="names-list" class="space-y-2 max-h-60 overflow-y-auto pr-2"><!-- Names will be added here -->
     </div><!-- Clear All Button --> <button id="clear-all-btn" class="w-full mt-4 py-2 bg-red-500/30 text-red-200 rounded-lg hover:bg-red-500/50 transition-all text-sm border border-red-500/30"> üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î </button>
    </div><!-- Center - Wheel -->
    <div class="flex-1 flex flex-col items-center"><!-- Lock Result Section -->
     <div class="w-full max-w-md bg-gradient-to-r from-yellow-500/20 to-orange-500/20 backdrop-blur-lg rounded-2xl p-4 mb-6 border border-yellow-500/30">
      <h3 class="text-yellow-300 font-semibold mb-3 flex items-center gap-2"><span>üîí</span> ‡∏•‡πá‡∏≠‡∏Ñ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
      <div class="flex gap-2"><select id="lock-select" class="flex-1 px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:outline-none focus:border-yellow-400 text-sm"> <option value="">-- ‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Ñ (‡∏™‡∏∏‡πà‡∏°‡∏õ‡∏Å‡∏ï‡∏¥) --</option> </select> <button id="lock-btn" class="px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg font-semibold hover:from-yellow-600 hover:to-orange-600 transition-all text-sm"> ‡∏•‡πá‡∏≠‡∏Ñ </button>
      </div>
      <div id="lock-status" class="mt-3 hidden">
       <div class="flex items-center gap-2 bg-yellow-500/30 rounded-lg px-3 py-2"><span class="text-yellow-300">üîê</span> <span class="text-yellow-100 text-sm">‡∏•‡πá‡∏≠‡∏Ñ‡∏ó‡∏µ‡πà: <strong id="locked-name"></strong></span> <button id="unlock-btn" class="ml-auto text-yellow-300 hover:text-white text-xs">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
       </div>
      </div>
     </div><!-- Wheel -->
     <div class="wheel-container relative mb-6"><!-- Pointer -->
      <div class="absolute -top-2 left-1/2 -translate-x-1/2 z-20">
       <div class="w-0 h-0 border-l-[15px] border-r-[15px] border-t-[30px] border-l-transparent border-r-transparent border-t-yellow-400 drop-shadow-lg"></div>
      </div>
      <canvas id="wheel" width="320" height="320" class="rounded-full"></canvas><!-- Center Circle -->
      <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg border-4 border-white/50"><span class="text-2xl">üé∞</span>
      </div>
     </div><!-- Spin Button --> <button id="spin-btn" class="px-10 py-4 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-white text-xl font-bold rounded-full hover:scale-105 transition-all shadow-xl glow-pulse disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100"> üé° ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡∏¢! </button> <!-- Result Display -->
     <div id="result-container" class="mt-6 hidden">
      <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl p-6 text-center shadow-2xl relative overflow-hidden">
       <div id="confetti-container" class="absolute inset-0 pointer-events-none"></div>
       <p class="text-white/80 text-sm mb-1">üéâ ‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠ üéâ</p>
       <p id="result-name" class="text-3xl font-bold text-white"></p>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      wheel_title: 'üéØ ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠',
      primary_color: '#4f46e5',
      secondary_color: '#ffffff',
      text_color: '#ffffff',
      accent_color: '#eab308',
      button_color: '#ec4899'
    };

    let names = [];
    let lockedName = null;
    let isSpinning = false;
    let currentRotation = 0;

    const colors = [
      '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', 
      '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F',
      '#BB8FCE', '#85C1E9', '#F8B500', '#FF8C00'
    ];

    // DOM Elements
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    const nameInput = document.getElementById('name-input');
    const addBtn = document.getElementById('add-btn');
    const namesList = document.getElementById('names-list');
    const nameCount = document.getElementById('name-count');
    const clearAllBtn = document.getElementById('clear-all-btn');
    const lockSelect = document.getElementById('lock-select');
    const lockBtn = document.getElementById('lock-btn');
    const lockStatus = document.getElementById('lock-status');
    const lockedNameEl = document.getElementById('locked-name');
    const unlockBtn = document.getElementById('unlock-btn');
    const spinBtn = document.getElementById('spin-btn');
    const resultContainer = document.getElementById('result-container');
    const resultName = document.getElementById('result-name');
    const wheelTitle = document.getElementById('wheel-title');

    // Initialize SDK
    window.elementSdk.init({
      defaultConfig,
      onConfigChange: async (config) => {
        wheelTitle.textContent = config.wheel_title || defaultConfig.wheel_title;
      },
      mapToCapabilities: (config) => ({
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      }),
      mapToEditPanelValues: (config) => new Map([
        ['wheel_title', config.wheel_title || defaultConfig.wheel_title]
      ])
    });

    // Draw Wheel
    function drawWheel() {
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = Math.min(centerX, centerY) - 10;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      if (names.length === 0) {
        // Draw empty wheel
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        ctx.fillStyle = '#374151';
        ctx.fill();
        ctx.strokeStyle = '#6B7280';
        ctx.lineWidth = 3;
        ctx.stroke();
        
        ctx.fillStyle = '#9CA3AF';
        ctx.font = '16px Prompt';
        ctx.textAlign = 'center';
        ctx.fillText('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', centerX, centerY);
        return;
      }

      const sliceAngle = (2 * Math.PI) / names.length;

      ctx.save();
      ctx.translate(centerX, centerY);
      ctx.rotate((currentRotation * Math.PI) / 180);
      ctx.translate(-centerX, -centerY);

      names.forEach((name, i) => {
        const startAngle = i * sliceAngle;
        const endAngle = startAngle + sliceAngle;

        // Draw slice
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.arc(centerX, centerY, radius, startAngle, endAngle);
        ctx.closePath();
        ctx.fillStyle = colors[i % colors.length];
        ctx.fill();
        ctx.strokeStyle = '#ffffff';
        ctx.lineWidth = 2;
        ctx.stroke();

        // Draw text
        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(startAngle + sliceAngle / 2);
        ctx.textAlign = 'right';
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 14px Prompt';
        ctx.shadowColor = 'rgba(0,0,0,0.5)';
        ctx.shadowBlur = 3;
        
        const maxLength = 10;
        const displayName = name.length > maxLength ? name.substring(0, maxLength) + '...' : name;
        ctx.fillText(displayName, radius - 20, 5);
        ctx.restore();
      });

      ctx.restore();

      // Draw border
      ctx.beginPath();
      ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
      ctx.strokeStyle = '#ffffff';
      ctx.lineWidth = 4;
      ctx.stroke();
    }

    // Update Names List UI
    function updateNamesList() {
      namesList.innerHTML = '';
      names.forEach((name, i) => {
        const div = document.createElement('div');
        div.className = 'name-item flex items-center gap-2 bg-white/10 rounded-lg px-3 py-2 transition-all';
        div.innerHTML = `
          <span class="w-6 h-6 rounded-full flex items-center justify-center text-xs text-white" style="background: ${colors[i % colors.length]}">${i + 1}</span>
          <span class="flex-1 text-white text-sm truncate">${name}</span>
          <button class="delete-btn text-red-300 hover:text-red-100 text-lg" data-index="${i}">√ó</button>
        `;
        namesList.appendChild(div);
      });

      nameCount.textContent = names.length;
      updateLockSelect();
      drawWheel();
    }

    // Update Lock Select Options
    function updateLockSelect() {
      const currentValue = lockSelect.value;
      lockSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Ñ (‡∏™‡∏∏‡πà‡∏°‡∏õ‡∏Å‡∏ï‡∏¥) --</option>';
      names.forEach((name, i) => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        lockSelect.appendChild(option);
      });
      if (names.includes(currentValue)) {
        lockSelect.value = currentValue;
      }
    }

    // Add Name
    function addName() {
      const name = nameInput.value.trim();
      if (name && !names.includes(name)) {
        names.push(name);
        nameInput.value = '';
        updateNamesList();
      }
    }

    // Delete Name
    function deleteName(index) {
      const removedName = names[index];
      names.splice(index, 1);
      if (lockedName === removedName) {
        lockedName = null;
        lockStatus.classList.add('hidden');
      }
      updateNamesList();
    }

    // Lock Name
    function lockName() {
      const selected = lockSelect.value;
      if (selected) {
        lockedName = selected;
        lockedNameEl.textContent = selected;
        lockStatus.classList.remove('hidden');
      }
    }

    // Unlock
    function unlock() {
      lockedName = null;
      lockStatus.classList.add('hidden');
      lockSelect.value = '';
    }

    // Create Confetti
    function createConfetti() {
      const container = document.getElementById('confetti-container');
      container.innerHTML = '';
      const confettiColors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFEAA7', '#DDA0DD'];
      
      for (let i = 0; i < 30; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.top = Math.random() * 50 + '%';
        confetti.style.backgroundColor = confettiColors[Math.floor(Math.random() * confettiColors.length)];
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        container.appendChild(confetti);
      }
    }

    // Spin Wheel
    function spin() {
      if (isSpinning || names.length < 2) return;

      isSpinning = true;
      spinBtn.disabled = true;
      resultContainer.classList.add('hidden');

      let targetIndex;
      if (lockedName && names.includes(lockedName)) {
        targetIndex = names.indexOf(lockedName);
      } else {
        targetIndex = Math.floor(Math.random() * names.length);
      }

      const sliceAngle = 360 / names.length;
      
      // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏°‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏•‡∏π‡∏Å‡∏®‡∏£ (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô = 270 ‡∏≠‡∏á‡∏®‡∏≤)
      // ‡∏•‡∏π‡∏Å‡∏®‡∏£‡∏ä‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏°‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 270 ‡∏≠‡∏á‡∏®‡∏≤
      const sliceMidAngle = targetIndex * sliceAngle + (sliceAngle / 2);
      const targetAngle = 270 - sliceMidAngle;
      
      // ‡∏´‡∏°‡∏∏‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≠‡∏ö + ‡∏°‡∏∏‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
      const spins = 5 + Math.random() * 3;
      const finalRotation = spins * 360 + targetAngle;
      
      // ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      const normalizedCurrent = currentRotation % 360;
      const totalRotation = finalRotation - normalizedCurrent + currentRotation;

      const startRotation = currentRotation;
      const duration = 5000;
      const startTime = Date.now();

      function animate() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // Easing function
        const easeOut = 1 - Math.pow(1 - progress, 4);
        
        currentRotation = startRotation + (totalRotation - startRotation) * easeOut;
        drawWheel();

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          isSpinning = false;
          spinBtn.disabled = false;
          
          // Show result
          resultName.textContent = names[targetIndex];
          resultContainer.classList.remove('hidden');
          createConfetti();
        }
      }

      animate();
    }

    // Event Listeners
    addBtn.addEventListener('click', addName);
    nameInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') addName();
    });

    namesList.addEventListener('click', (e) => {
      if (e.target.classList.contains('delete-btn')) {
        deleteName(parseInt(e.target.dataset.index));
      }
    });

    clearAllBtn.addEventListener('click', () => {
      names = [];
      lockedName = null;
      lockStatus.classList.add('hidden');
      updateNamesList();
      resultContainer.classList.add('hidden');
    });

    lockBtn.addEventListener('click', lockName);
    unlockBtn.addEventListener('click', unlock);
    spinBtn.addEventListener('click', spin);

    // Add sample names
    names = ['‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 1', '‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 2', '‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 3', '‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 4', '‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 5'];
    updateNamesList();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b66bca1a66c8938',t:'MTc2NzE1MjIzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
