<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e5e7eb;
        }
        .calendar-day {
            background-color: white;
            min-height: 120px;
            padding: 8px;
            position: relative;
        }
        .task-item {
            font-size: 11px;
            padding: 2px 4px;
            margin: 1px 0;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .task-item:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .priority-high { background-color: #fecaca; border-left: 3px solid #ef4444; }
        .priority-medium { background-color: #fed7aa; border-left: 3px solid #f97316; }
        .priority-low { background-color: #dcfce7; border-left: 3px solid #22c55e; }
        .status-pending { opacity: 1; }
        .status-progress { opacity: 0.8; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,.1) 10px, rgba(255,255,255,.1) 20px); }
        .status-completed { opacity: 0.6; text-decoration: line-through; }
    </style>
</head>
<body class="bg-gray-50 min-h-full">
    <div class="container mx-auto p-6 max-w-7xl">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á</h1>
            
            <!-- Controls -->
            <div class="flex flex-wrap gap-4 items-center justify-between">
                <div class="flex gap-4 items-center">
                    <button id="prevMonth" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                    </button>
                    <h2 id="currentMonth" class="text-xl font-semibold text-gray-700"></h2>
                    <button id="nextMonth" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí
                    </button>
                </div>
                
                <div class="flex gap-2">
                    <button id="addTaskBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
                    </button>
                    <button id="exportBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
            </div>
        </div>

        <!-- Calendar -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <!-- Days Header -->
            <div class="calendar-grid bg-gray-100 text-center font-semibold text-gray-700">
                <div class="p-4 border-r border-gray-200">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</div>
                <div class="p-4 border-r border-gray-200">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
                <div class="p-4 border-r border-gray-200">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div>
                <div class="p-4 border-r border-gray-200">‡∏û‡∏∏‡∏ò</div>
                <div class="p-4 border-r border-gray-200">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</div>
                <div class="p-4 border-r border-gray-200">‡∏®‡∏∏‡∏Å‡∏£‡πå</div>
                <div class="p-4">‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
            </div>
            
            <!-- Calendar Days -->
            <div id="calendarDays" class="calendar-grid"></div>
        </div>

        <!-- Task Summary -->
        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span>‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                        <span id="totalTasks" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</span>
                        <span id="pendingTasks" class="font-semibold text-orange-600">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:</span>
                        <span id="completedTasks" class="font-semibold text-green-600">0</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üéØ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-red-200 border-l-4 border-red-500 rounded"></div>
                        <span>‡∏™‡∏π‡∏á</span>
                        <span id="highPriority" class="ml-auto font-semibold">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-orange-200 border-l-4 border-orange-500 rounded"></div>
                        <span>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
                        <span id="mediumPriority" class="ml-auto font-semibold">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-green-200 border-l-4 border-green-500 rounded"></div>
                        <span>‡∏ï‡πà‡∏≥</span>
                        <span id="lowPriority" class="ml-auto font-semibold">0</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <div class="space-y-2">
                    <input type="text" id="apiKey" placeholder="Google API Key (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    <input type="text" id="sheetId" placeholder="Google Sheet ID" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    <button id="testConnectionBtn" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-sm transition-colors mb-2">
                        üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                    </button>
                    <div class="flex gap-2">
                        <button id="syncToSheetBtn" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg text-sm transition-colors">
                            üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV
                        </button>
                        <button id="syncFromSheetBtn" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg text-sm transition-colors">
                            üì§ ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Sheet
                        </button>
                    </div>
                    <button id="setupGuideBtn" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg text-sm transition-colors">
                        üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Setup Guide Modal -->
    <div id="setupGuideModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets API</h3>
                <button id="closeGuideBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">üéØ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏î‡πâ</h4>
                    <ul class="text-blue-700 space-y-1 text-sm">
                        <li>‚Ä¢ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV</li>
                        <li>‚Ä¢ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏ü‡∏•‡πå CSV ‡πÑ‡∏õ Google Sheets ‡πÑ‡∏î‡πâ</li>
                        <li>‚Ä¢ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
                    </ul>
                </div>

                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á Google Sheets API</h4>
                    <p class="text-yellow-700 text-sm mb-2">Google ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ API Key ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ OAuth2 ‡∏ã‡∏∂‡πà‡∏á‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏°‡∏≤‡∏Å</p>
                    <p class="text-yellow-700 text-sm"><strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:</strong> ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</p>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-3">üì• ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
                        <ol class="space-y-2 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <span>‡∏Å‡∏î "üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <span>‡πÄ‡∏õ‡∏¥‡∏î Google Sheets</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <span>File ‚Üí Import ‚Üí Upload</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <span>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">5</span>
                                <span>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Replace spreadsheet"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">6</span>
                                <span>‡∏Å‡∏î "Import data"</span>
                            </li>
                        </ol>
                    </div>

                    <div>
                        <h4 class="font-semibold mb-3">üì§ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheet</h4>
                        <ol class="space-y-2 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <span>‡πÉ‡∏™‡πà API Key ‡πÅ‡∏•‡∏∞ Sheet ID</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <span>‡∏Å‡∏î "üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <span>‡∏Å‡∏î "üì§ ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Sheet"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
                            </li>
                        </ol>
                        
                        <div class="mt-4 p-3 bg-blue-50 rounded">
                            <p class="text-blue-700 text-xs"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ API Key ‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">‚úÖ ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ</h4>
                    <ul class="text-green-700 space-y-1 text-sm">
                        <li>‚Ä¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ OAuth2 ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô</li>
                        <li>‚Ä¢ ‡πÑ‡∏ü‡∏•‡πå CSV ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</li>
                        <li>‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå</li>
                        <li>‚Ä¢ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div id="taskModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô</h3>
            
            <form id="taskForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô</label>
                    <input type="text" id="taskTitle" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="taskDescription" rows="3" 
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
                        <input type="date" id="taskDate" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
                        <input type="time" id="taskTime" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                    <input type="date" id="taskDueDate" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                        <select id="taskPriority" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="low">‡∏ï‡πà‡∏≥</option>
                            <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                            <option value="high">‡∏™‡∏π‡∏á</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="taskStatus" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="progress">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</option>
                            <option value="completed">‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
                    <input type="text" id="taskAssignee" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                    <button type="button" id="deleteTaskBtn" class="px-4 bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition-colors hidden">
                        ‡∏•‡∏ö
                    </button>
                    <button type="button" id="cancelBtn" class="px-4 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        class TaskScheduler {
            constructor() {
                this.currentDate = new Date();
                this.tasks = JSON.parse(localStorage.getItem('schedulerTasks')) || [];
                this.currentEditingTask = null;
                
                this.initializeElements();
                this.bindEvents();
                this.loadSavedConfig();
                this.renderCalendar();
                this.updateStats();
            }
            
            initializeElements() {
                this.calendarDays = document.getElementById('calendarDays');
                this.currentMonthEl = document.getElementById('currentMonth');
                this.taskModal = document.getElementById('taskModal');
                this.taskForm = document.getElementById('taskForm');
            }
            
            bindEvents() {
                // Navigation
                document.getElementById('prevMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });
                
                document.getElementById('nextMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });
                
                // Modal controls
                document.getElementById('addTaskBtn').addEventListener('click', () => this.openTaskModal());
                document.getElementById('cancelBtn').addEventListener('click', () => this.closeTaskModal());
                document.getElementById('deleteTaskBtn').addEventListener('click', () => this.deleteTask());
                
                // Form submission
                this.taskForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveTask();
                });
                
                // Export and sync
                document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
                document.getElementById('setupGuideBtn').addEventListener('click', () => this.openSetupGuide());
                document.getElementById('closeGuideBtn').addEventListener('click', () => this.closeSetupGuide());
                document.getElementById('testConnectionBtn').addEventListener('click', () => this.testGoogleSheetsConnection());
                document.getElementById('syncToSheetBtn').addEventListener('click', () => this.syncToGoogleSheets());
                document.getElementById('syncFromSheetBtn').addEventListener('click', () => this.syncFromGoogleSheets());
                
                // Close modal on outside click
                this.taskModal.addEventListener('click', (e) => {
                    if (e.target === this.taskModal) this.closeTaskModal();
                });
            }
            
            renderCalendar() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // Update month display
                const monthNames = [
                    '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                    '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
                ];
                this.currentMonthEl.textContent = `${monthNames[month]} ${year + 543}`;
                
                // Calculate calendar days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());
                
                // Clear calendar
                this.calendarDays.innerHTML = '';
                
                // Generate calendar days
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    const dayEl = this.createDayElement(date, month);
                    this.calendarDays.appendChild(dayEl);
                }
            }
            
            createDayElement(date, currentMonth) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                
                const isCurrentMonth = date.getMonth() === currentMonth;
                const isToday = this.isToday(date);
                
                if (!isCurrentMonth) {
                    dayEl.classList.add('opacity-30');
                }
                
                if (isToday) {
                    dayEl.classList.add('bg-blue-50', 'border-2', 'border-blue-300');
                }
                
                // Day number
                const dayNumber = document.createElement('div');
                dayNumber.className = `text-sm font-semibold mb-1 ${isToday ? 'text-blue-600' : 'text-gray-700'}`;
                dayNumber.textContent = date.getDate();
                dayEl.appendChild(dayNumber);
                
                // Add tasks for this day
                const dayTasks = this.getTasksForDate(date);
                dayTasks.forEach(task => {
                    const taskEl = this.createTaskElement(task);
                    dayEl.appendChild(taskEl);
                });
                
                // Add click handler for adding tasks
                dayEl.addEventListener('click', (e) => {
                    if (e.target === dayEl || e.target === dayNumber) {
                        this.openTaskModal(date);
                    }
                });
                
                return dayEl;
            }
            
            createTaskElement(task) {
                const taskEl = document.createElement('div');
                taskEl.className = `task-item priority-${task.priority} status-${task.status}`;
                
                const time = task.time ? ` ${task.time}` : '';
                const dueDate = task.dueDate ? `üìÖ ${task.dueDate}` : '';
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏•‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const isOverdue = task.dueDate && new Date(task.dueDate) < new Date() && task.status !== 'completed';
                if (isOverdue) {
                    taskEl.classList.add('border-2', 'border-red-400');
                }
                
                taskEl.innerHTML = `
                    <div class="font-medium truncate">${task.title}</div>
                    ${time ? `<div class="text-xs opacity-75">‚è∞ ${time}</div>` : ''}
                    ${dueDate ? `<div class="text-xs opacity-75 ${isOverdue ? 'text-red-600 font-semibold' : ''}">${dueDate}</div>` : ''}
                    ${task.assignee ? `<div class="text-xs opacity-75">üë§ ${task.assignee}</div>` : ''}
                `;
                
                taskEl.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.editTask(task);
                });
                
                return taskEl;
            }
            
            getTasksForDate(date) {
                const dateStr = this.formatDate(date);
                return this.tasks.filter(task => task.date === dateStr);
            }
            
            isToday(date) {
                const today = new Date();
                return date.toDateString() === today.toDateString();
            }
            
            formatDate(date) {
                return date.toISOString().split('T')[0];
            }
            
            openTaskModal(date = null) {
                this.currentEditingTask = null;
                this.taskForm.reset();
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                const now = new Date();
                const currentDate = date ? this.formatDate(date) : this.formatDate(now);
                const currentTime = now.toTimeString().slice(0, 5); // HH:MM format
                
                document.getElementById('taskDate').value = currentDate;
                document.getElementById('taskTime').value = currentTime;
                
                document.getElementById('deleteTaskBtn').classList.add('hidden');
                this.taskModal.classList.remove('hidden');
                this.taskModal.classList.add('flex');
                
                // Focus on title input
                setTimeout(() => {
                    document.getElementById('taskTitle').focus();
                }, 100);
            }
            
            editTask(task) {
                this.currentEditingTask = task;
                
                // Populate form
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description || '';
                document.getElementById('taskDate').value = task.date;
                document.getElementById('taskTime').value = task.time || '';
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskStatus').value = task.status;
                document.getElementById('taskAssignee').value = task.assignee || '';
                document.getElementById('taskDueDate').value = task.dueDate || '';
                
                document.getElementById('deleteTaskBtn').classList.remove('hidden');
                this.taskModal.classList.remove('hidden');
                this.taskModal.classList.add('flex');
            }
            
            closeTaskModal() {
                this.taskModal.classList.add('hidden');
                this.taskModal.classList.remove('flex');
                this.currentEditingTask = null;
            }
            
            saveTask() {
                const taskData = {
                    id: this.currentEditingTask ? this.currentEditingTask.id : Date.now(),
                    title: document.getElementById('taskTitle').value,
                    description: document.getElementById('taskDescription').value,
                    date: document.getElementById('taskDate').value,
                    time: document.getElementById('taskTime').value,
                    priority: document.getElementById('taskPriority').value,
                    status: document.getElementById('taskStatus').value,
                    assignee: document.getElementById('taskAssignee').value,
                    dueDate: document.getElementById('taskDueDate').value,
                    createdAt: this.currentEditingTask ? this.currentEditingTask.createdAt : new Date().toISOString()
                };
                
                if (this.currentEditingTask) {
                    // Update existing task
                    const index = this.tasks.findIndex(t => t.id === this.currentEditingTask.id);
                    this.tasks[index] = taskData;
                } else {
                    // Add new task
                    this.tasks.push(taskData);
                }
                
                this.saveTasks();
                this.renderCalendar();
                this.updateStats();
                this.closeTaskModal();
            }
            
            deleteTask() {
                if (this.currentEditingTask && confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    this.tasks = this.tasks.filter(t => t.id !== this.currentEditingTask.id);
                    this.saveTasks();
                    this.renderCalendar();
                    this.updateStats();
                    this.closeTaskModal();
                }
            }
            
            saveTasks() {
                localStorage.setItem('schedulerTasks', JSON.stringify(this.tasks));
            }
            
            updateStats() {
                const total = this.tasks.length;
                const pending = this.tasks.filter(t => t.status === 'pending').length;
                const completed = this.tasks.filter(t => t.status === 'completed').length;
                const high = this.tasks.filter(t => t.priority === 'high').length;
                const medium = this.tasks.filter(t => t.priority === 'medium').length;
                const low = this.tasks.filter(t => t.priority === 'low').length;
                
                document.getElementById('totalTasks').textContent = total;
                document.getElementById('pendingTasks').textContent = pending;
                document.getElementById('completedTasks').textContent = completed;
                document.getElementById('highPriority').textContent = high;
                document.getElementById('mediumPriority').textContent = medium;
                document.getElementById('lowPriority').textContent = low;
            }
            
            exportData() {
                const csvContent = this.generateCSV();
                const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á_${new Date().toISOString().split('T')[0]}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
            
            generateCSV() {
                const headers = ['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°', '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°', '‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô', '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î', '‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à'];
                const rows = this.tasks.map(task => [
                    task.date,
                    task.time || '',
                    task.title,
                    task.description || '',
                    task.assignee || '',
                    task.priority === 'high' ? '‡∏™‡∏π‡∏á' : task.priority === 'medium' ? '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' : '‡∏ï‡πà‡∏≥',
                    task.status === 'pending' ? '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' : task.status === 'progress' ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' : '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß',
                    task.dueDate || ''
                ]);
                
                return [headers, ...rows].map(row => 
                    row.map(field => `"${field}"`).join(',')
                ).join('\n');
            }
            
            openSetupGuide() {
                document.getElementById('setupGuideModal').classList.remove('hidden');
                document.getElementById('setupGuideModal').classList.add('flex');
            }
            
            closeSetupGuide() {
                document.getElementById('setupGuideModal').classList.add('hidden');
                document.getElementById('setupGuideModal').classList.remove('flex');
            }
            
            async syncToGoogleSheets() {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (this.tasks.length === 0) {
                    this.showMessage('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                    return;
                }

                try {
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
                    const csvContent = this.generateCSV();
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå
                    const today = new Date();
                    const dateStr = today.getFullYear() + '-' + 
                                  String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                                  String(today.getDate()).padStart(2, '0');
                    const fileName = `tasks_${dateStr}.csv`;
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á Blob
                    const blob = new Blob(['\uFEFF' + csvContent], { 
                        type: 'text/csv;charset=utf-8;' 
                    });
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    
                    link.href = url;
                    link.download = fileName;
                    link.style.display = 'none';
                    
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏•‡∏á‡πÉ‡∏ô DOM ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å
                    document.body.appendChild(link);
                    link.click();
                    
                    // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                    }, 100);
                    
                    this.showMessage(`‚úÖ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå CSV ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! (${this.tasks.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`, 'success');
                    
                } catch (error) {
                    console.error('Error downloading CSV:', error);
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                    const csvContent = this.generateCSV();
                    this.showCSVModal(csvContent);
                    
                    this.showMessage('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏ó‡∏ô', 'warning');
                }
            }
            
            async syncFromGoogleSheets() {
                const apiKey = document.getElementById('apiKey').value;
                const sheetId = document.getElementById('sheetId').value;
                
                if (!apiKey || !sheetId) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡πÅ‡∏•‡∏∞ Sheet ID ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'warning');
                    return;
                }
                
                try {
                    const response = await fetch(
                        `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Sheet1!A2:H1000?key=${apiKey}`
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        const rows = data.values || [];
                        
                        // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÄ‡∏õ‡πá‡∏ô tasks
                        const importedTasks = rows
                            .filter(row => row[0] && row[2]) // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô
                            .map((row, index) => ({
                                id: Date.now() + index,
                                date: row[0] || '',
                                time: row[1] || '',
                                title: row[2] || '',
                                description: row[3] || '',
                                assignee: row[4] || '',
                                priority: row[5] === '‡∏™‡∏π‡∏á' ? 'high' : row[5] === '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' ? 'medium' : 'low',
                                status: row[6] === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'pending' : row[6] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' ? 'progress' : 'completed',
                                dueDate: row[7] || '',
                                createdAt: new Date().toISOString()
                            }));
                        
                        if (importedTasks.length > 0) {
                            // ‡∏™‡∏£‡πâ‡∏≤‡∏á confirmation modal
                            this.showConfirmModal(
                                `‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${importedTasks.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô Google Sheets`,
                                '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
                                () => {
                                    this.tasks = importedTasks;
                                    this.saveTasks();
                                    this.renderCalendar();
                                    this.updateStats();
                                    this.showMessage(`‚úÖ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${importedTasks.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å Google Sheets ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`, 'success');
                                }
                            );
                        } else {
                            this.showMessage('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'warning');
                        }
                    } else {
                        const error = await response.json();
                        throw new Error(error.error?.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                    }
                } catch (error) {
                    console.error('Error syncing from Google Sheets:', error);
                    this.showMessage(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                }
            }
            
            showMessage(message, type = 'info') {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á notification element
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md transition-all duration-300 transform translate-x-full`;
                
                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                switch (type) {
                    case 'success':
                        notification.classList.add('bg-green-500', 'text-white');
                        break;
                    case 'warning':
                        notification.classList.add('bg-yellow-500', 'text-white');
                        break;
                    case 'error':
                        notification.classList.add('bg-red-500', 'text-white');
                        break;
                    default:
                        notification.classList.add('bg-blue-500', 'text-white');
                }
                
                notification.innerHTML = `
                    <div class="flex items-start gap-3">
                        <div class="flex-1 text-sm">${message}</div>
                        <button class="text-white hover:text-gray-200 text-lg leading-none" onclick="this.parentElement.parentElement.remove()">√ó</button>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // ‡πÅ‡∏™‡∏î‡∏á notification
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                // ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 300);
                }, 5000);
            }
            
            showCSVModal(csvContent) {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á (CSV)</h3>
                            <button class="text-gray-500 hover:text-gray-700 text-2xl" onclick="this.closest('.fixed').remove()">&times;</button>
                        </div>
                        
                        <div class="bg-yellow-50 p-4 rounded-lg mb-4">
                            <p class="text-yellow-800 text-sm">
                                <strong>üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‚Üí File ‚Üí Import ‚Üí Paste
                            </p>
                        </div>
                        
                        <div class="flex-1 overflow-hidden">
                            <textarea class="w-full h-full min-h-[400px] p-3 border border-gray-300 rounded-lg font-mono text-sm resize-none" readonly>${csvContent}</textarea>
                        </div>
                        
                        <div class="flex gap-3 mt-4">
                            <button onclick="
                                const textarea = this.closest('.bg-white').querySelector('textarea');
                                textarea.select();
                                document.execCommand('copy');
                                this.textContent = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                                setTimeout(() => { this.textContent = 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'; }, 2000);
                            " class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition-colors">
                                üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                            <button onclick="this.closest('.fixed').remove()" class="px-6 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors">
                                ‡∏õ‡∏¥‡∏î
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Focus ‡∏ó‡∏µ‡πà textarea
                setTimeout(() => {
                    const textarea = modal.querySelector('textarea');
                    textarea.focus();
                    textarea.select();
                }, 100);
                
                this.showMessage('üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Google Sheets ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!', 'info');
            }
            
            showConfirmModal(title, message, onConfirm) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                        <h3 class="text-lg font-semibold mb-4">${title}</h3>
                        <p class="text-gray-600 mb-6">${message}</p>
                        <div class="flex gap-3">
                            <button class="confirm-btn flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors">
                                ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                            </button>
                            <button class="cancel-btn flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                        </div>
                    </div>
                `;
                
                const confirmBtn = modal.querySelector('.confirm-btn');
                const cancelBtn = modal.querySelector('.cancel-btn');
                
                confirmBtn.addEventListener('click', () => {
                    modal.remove();
                    onConfirm();
                });
                
                cancelBtn.addEventListener('click', () => {
                    modal.remove();
                });
                
                document.body.appendChild(modal);
            }
            
            showDetailedError(title, message, details = {}) {
                console.error('üö® ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', { title, message, details });
                
                let detailsText = '';
                if (Object.keys(details).length > 0) {
                    detailsText = '\n\nüìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:\n';
                    for (const [key, value] of Object.entries(details)) {
                        if (typeof value === 'object') {
                            detailsText += `‚Ä¢ ${key}: ${JSON.stringify(value, null, 2)}\n`;
                        } else {
                            detailsText += `‚Ä¢ ${key}: ${value}\n`;
                        }
                    }
                }
                
                const fullMessage = `‚ùå ${title}\n\n${message}${detailsText}\n\nüí° ‡πÄ‡∏õ‡∏¥‡∏î Developer Tools (F12) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°`;
                this.showMessage(fullMessage, 'error');
            }
            
            async testGoogleSheetsConnection() {
                const apiKey = document.getElementById('apiKey').value.trim();
                const sheetId = document.getElementById('sheetId').value.trim();
                
                if (!apiKey || !sheetId) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡πÅ‡∏•‡∏∞ Sheet ID ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'warning');
                    return;
                }
                
                const testBtn = document.getElementById('testConnectionBtn');
                const originalText = testBtn.textContent;
                testBtn.textContent = 'üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                testBtn.disabled = true;
                
                try {
                    console.log('üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets...');
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö API Key ‡πÅ‡∏•‡∏∞ Sheet ID
                    const apiKeyValid = apiKey.length >= 35 && apiKey.startsWith('AIza');
                    const sheetIdValid = sheetId.length >= 40 && /^[a-zA-Z0-9-_]+$/.test(sheetId);
                    
                    console.log('üìã ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:', {
                        apiKeyLength: apiKey.length,
                        apiKeyFormat: apiKey.substring(0, 10) + '...',
                        apiKeyValid: apiKeyValid,
                        sheetIdLength: sheetId.length,
                        sheetIdFormat: sheetId.substring(0, 20) + '...',
                        sheetIdValid: sheetIdValid
                    });
                    
                    // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets API
                    const testUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}?key=${apiKey}`;
                    console.log('üåê ‡∏ó‡∏î‡∏™‡∏≠‡∏ö URL:', testUrl);
                    
                    const response = await fetch(testUrl);
                    console.log('üì° HTTP Status:', response.status);
                    console.log('üì° HTTP Headers:', Object.fromEntries(response.headers.entries()));
                    
                    if (response.ok) {
                        const sheetData = await response.json();
                        console.log('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Sheet:', sheetData);
                        
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ Sheet1 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                        const sheets = sheetData.sheets || [];
                        const sheet1 = sheets.find(s => s.properties.title === 'Sheet1');
                        
                        this.showMessage(`‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Sheet: "${sheetData.properties?.title || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠'}" (${sheets.length} ‡πÅ‡∏ú‡πà‡∏ô)`, 'success');
                        
                        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
                        localStorage.setItem('googleSheetsConfig', JSON.stringify({
                            apiKey: apiKey,
                            sheetId: sheetId
                        }));
                        
                    } else {
                        const errorText = await response.text();
                        console.error('‚ùå Error Response:', errorText);
                        
                        let parsedError;
                        try {
                            parsedError = JSON.parse(errorText);
                        } catch (e) {
                            parsedError = { error: { message: errorText } };
                        }
                        
                        let errorMessage = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ';
                        
                        if (response.status === 403) {
                            errorMessage = '‚ùå API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á';
                        } else if (response.status === 404) {
                            errorMessage = '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö Google Sheet ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sheet ID ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå';
                        } else if (response.status === 400) {
                            errorMessage = '‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö API Key ‡πÅ‡∏•‡∏∞ Sheet ID';
                        }
                        
                        this.showMessage(errorMessage, 'error');
                    }
                    
                } catch (error) {
                    console.error('üí• Network Error:', error);
                    this.showMessage(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢: ${error.message}`, 'error');
                } finally {
                    testBtn.textContent = originalText;
                    testBtn.disabled = false;
                }
            }
            

            
            loadSavedConfig() {
                const saved = localStorage.getItem('googleSheetsConfig');
                if (saved) {
                    const config = JSON.parse(saved);
                    document.getElementById('apiKey').value = config.apiKey || '';
                    document.getElementById('sheetId').value = config.sheetId || '';
                }
            }
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new TaskScheduler();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98dc2da94162f8e6',t:'MTc2MDMzMDYzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
