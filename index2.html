<!DOCTYPE html>
<html lang="th">
<!--
üîß ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î JavaScript ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
========================================================

1. üìä Google Apps Script URL (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1036):
   this.DEFAULT_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID_HERE/exec';
   
2. üì± LINE Bot Configuration (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1040-1041):
   this.DEFAULT_LINE_CHANNEL_ACCESS_TOKEN = 'YOUR_LINE_CHANNEL_ACCESS_TOKEN_HERE';
   this.DEFAULT_LINE_USER_ID = 'YOUR_LINE_USER_ID_HERE';

3. üöÄ ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1044-1045):
   this.DEFAULT_AUTO_SYNC = true;        // ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
   this.DEFAULT_LINE_NOTIFY = true;      // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥!
========================================================
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e5e7eb;
        }
        .calendar-day {
            background-color: white;
            min-height: 120px;
            padding: 8px;
            position: relative;
        }
        .task-item {
            font-size: 11px;
            padding: 2px 4px;
            margin: 1px 0;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .task-item:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .priority-high { background-color: #fecaca; border-left: 3px solid #ef4444; }
        .priority-medium { background-color: #fed7aa; border-left: 3px solid #f97316; }
        .priority-low { background-color: #dcfce7; border-left: 3px solid #22c55e; }
        .status-pending { opacity: 1; }
        .status-progress { opacity: 0.8; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,.1) 10px, rgba(255,255,255,.1) 20px); }
        .status-completed { opacity: 0.6; text-decoration: line-through; }
        .sync-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .sync-online { background-color: #10b981; color: white; }
        .sync-offline { background-color: #ef4444; color: white; }
        .sync-syncing { background-color: #f59e0b; color: white; animation: pulse 1s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .overdue-task {
            border-left: 4px solid #ef4444 !important;
            background-color: #fef2f2 !important;
        }
        .due-soon-task {
            border-left: 4px solid #f59e0b !important;
            background-color: #fffbeb !important;
        }
        .image-preview {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
        }
        .image-gallery {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }
        .notification-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 350px;
            max-height: 400px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            z-index: 1000;
            overflow: hidden;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        .notification-panel.show {
            transform: translateX(0);
        }
        .notification-item {
            padding: 12px 16px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .notification-item:hover {
            background-color: #f9fafb;
        }
        .notification-item.overdue {
            border-left: 4px solid #ef4444;
            background-color: #fef2f2;
        }
        .notification-item.due-soon {
            border-left: 4px solid #f59e0b;
            background-color: #fffbeb;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-full">
    <!-- Sync Status Indicator -->
    <div id="syncIndicator" class="sync-indicator sync-offline">
        üî¥ ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå
    </div>

    <!-- Notification Bell -->
    <div id="notificationBell" class="fixed top-20px right-80px z-50 cursor-pointer bg-white rounded-full p-3 shadow-lg hover:shadow-xl transition-all" style="top: 20px; right: 200px;">
        <div class="relative">
            üîî
            <div id="notificationBadge" class="notification-badge hidden">0</div>
        </div>
    </div>

    <!-- Notification Panel -->
    <div id="notificationPanel" class="notification-panel">
        <div class="bg-gray-50 px-4 py-3 border-b">
            <div class="flex justify-between items-center">
                <h3 class="font-semibold text-gray-800">üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                <button id="closeNotifications" class="text-gray-500 hover:text-gray-700">&times;</button>
            </div>
        </div>
        <div id="notificationList" class="overflow-y-auto max-h-80">
            <div class="p-4 text-center text-gray-500 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
        </div>
    </div>

    <div class="container mx-auto p-6 max-w-6xl">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á</h1>
            
            <!-- Controls -->
            <div class="flex flex-wrap gap-4 items-center justify-between">
                <div class="flex gap-4 items-center">
                    <button id="prevMonth" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                    </button>
                    <h2 id="currentMonth" class="text-xl font-semibold text-gray-700"></h2>
                    <button id="nextMonth" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí
                    </button>
                </div>
                
                <div class="flex gap-2">
                    <button id="addTaskBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
                    </button>
                    <button id="manageTechniciansBtn" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á
                    </button>
                    <button id="forceSyncBtn" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üîÑ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    </button>
                    <button id="exportBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
            </div>
        </div>

        <!-- Calendar -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <!-- Days Header -->
            <div class="calendar-grid bg-gray-100 text-center font-semibold text-gray-700">
                <div class="p-4 border-r border-gray-200">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</div>
                <div class="p-4 border-r border-gray-200">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
                <div class="p-4 border-r border-gray-200">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div>
                <div class="p-4 border-r border-gray-200">‡∏û‡∏∏‡∏ò</div>
                <div class="p-4 border-r border-gray-200">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</div>
                <div class="p-4 border-r border-gray-200">‡∏®‡∏∏‡∏Å‡∏£‡πå</div>
                <div class="p-4">‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
            </div>
            
            <!-- Calendar Days -->
            <div id="calendarDays" class="calendar-grid"></div>
        </div>

        <!-- Task Summary -->
        <div class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span>‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                        <span id="totalTasks" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</span>
                        <span id="pendingTasks" class="font-semibold text-orange-600">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:</span>
                        <span id="completedTasks" class="font-semibold text-green-600">0</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üéØ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-red-200 border-l-4 border-red-500 rounded"></div>
                        <span>‡∏™‡∏π‡∏á</span>
                        <span id="highPriority" class="ml-auto font-semibold">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-orange-200 border-l-4 border-orange-500 rounded"></div>
                        <span>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
                        <span id="mediumPriority" class="ml-auto font-semibold">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 bg-green-200 border-l-4 border-green-500 rounded"></div>
                        <span>‡∏ï‡πà‡∏≥</span>
                        <span id="lowPriority" class="ml-auto font-semibold">0</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üåê ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h3>
                <div class="space-y-2">
                    <div class="text-xs bg-green-50 p-2 rounded border-l-4 border-green-500">
                        <p class="font-semibold text-green-800">‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡πâ‡∏ß!</p>
                        <p class="text-green-700">‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥</p>
                    </div>
                    <input type="text" id="appsScriptUrl" placeholder="Google Apps Script URL" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50" readonly>
                    <div class="flex items-center gap-2 text-sm">
                        <input type="checkbox" id="autoSync" class="rounded">
                        <label for="autoSync">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</label>
                    </div>
                    <button id="testConnectionBtn" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-sm transition-colors mb-2">
                        üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                    </button>
                    <div class="flex gap-2">
                        <button id="syncToSheetBtn" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg text-sm transition-colors">
                            üì§ ‡∏™‡πà‡∏á‡πÑ‡∏õ Sheet
                        </button>
                        <button id="syncFromSheetBtn" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg text-sm transition-colors">
                            üì• ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Sheet
                        </button>
                    </div>
                    <button id="setupGuideBtn" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg text-sm transition-colors">
                        üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold text-gray-700 mb-2">üì± ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE</h3>
                <div class="space-y-2">
                    <div class="text-xs bg-blue-50 p-2 rounded border-l-4 border-blue-500">
                        <p class="font-semibold text-blue-800">üîß ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡πâ‡∏ß!</p>
                        <p class="text-blue-700">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
                    </div>
                    <input type="text" id="lineChannelAccessToken" placeholder="Channel Access Token" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50" readonly>
                    <input type="text" id="lineUserId" placeholder="User ID ‡∏´‡∏£‡∏∑‡∏≠ Group ID" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50" readonly>
                    <div class="flex items-center gap-2 text-sm">
                        <input type="checkbox" id="enableLineNotify" class="rounded">
                        <label for="enableLineNotify">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE</label>
                    </div>
                    <button id="testLineBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg text-sm transition-colors">
                        üì± ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                    </button>
                    <button id="lineSetupBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg text-sm transition-colors">
                        üìñ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Bot
                    </button>
                    <div class="text-xs text-green-600 bg-green-50 p-2 rounded">
                        <p class="font-semibold">üöÄ ‡∏™‡πà‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô Apps Script!</p>
                        <p>‚Ä¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô</p>
                        <p>‚Ä¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                        <p>‚Ä¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Setup Guide Modal -->
    <div id="setupGuideModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script</h3>
                <button id="closeGuideBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h4>
                    <p class="text-green-700 text-sm mb-2">‡πÉ‡∏ä‡πâ Google Apps Script ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                    <p class="text-green-700 text-sm"><strong>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:</strong> ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</p>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-3">üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Apps Script</h4>
                        <ol class="space-y-3 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <div>
                                    <div>‡πÄ‡∏õ‡∏¥‡∏î <a href="https://script.google.com" target="_blank" class="text-blue-600 underline font-semibold">script.google.com</a></div>
                                    <div class="text-xs text-gray-600 mt-1">‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Google Account</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <div>
                                    <div>‡∏Å‡∏î <strong>"New project"</strong> (‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)</div>
                                    <div class="text-xs text-gray-600 mt-1">‡∏´‡∏£‡∏∑‡∏≠ "+ New project" ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <div>
                                    <div><strong>‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</strong> ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á</div>
                                    <div class="text-xs text-gray-600 mt-1">‡∏•‡∏ö function myFunction() {...} ‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <div>
                                    <div><strong>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç SHEET_ID</strong> ‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2</div>
                                    <div class="text-xs text-gray-600 mt-1">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô 'YOUR_SHEET_ID_HERE' ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏à‡∏£‡∏¥‡∏á</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">5</span>
                                <div>
                                    <div>‡∏Å‡∏î <strong>"Deploy"</strong> ‚Üí <strong>"New deployment"</strong></div>
                                    <div class="text-xs text-gray-600 mt-1">‡∏õ‡∏∏‡πà‡∏° Deploy ‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">6</span>
                                <div>
                                    <div>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Type: <strong>"Web app"</strong></div>
                                    <div>Execute as: <strong>"Me"</strong></div>
                                    <div>Who has access: <strong>"Anyone"</strong></div>
                                    <div class="text-xs text-red-600 mt-1">‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Anyone" ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">7</span>
                                <div>
                                    <div>‡∏Å‡∏î <strong>"Deploy"</strong> ‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</div>
                                    <div class="text-xs text-gray-600 mt-1">‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á</div>
                                </div>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">8</span>
                                <div>
                                    <div><strong>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Web app URL</strong> ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</div>
                                    <div class="text-xs text-gray-600 mt-1">URL ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ https://script.google.com/macros/s/...</div>
                                </div>
                            </li>
                        </ol>
                    </div>

                    <div>
                        <h4 class="font-semibold mb-3">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Sheets</h4>
                        <ol class="space-y-2 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <span>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <span>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Sheet ID ‡∏à‡∏≤‡∏Å URL</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <span>‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°, ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°, ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞, ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à, ‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô, ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <span>‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ "Anyone with the link" ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ "Edit" ‡πÑ‡∏î‡πâ</span>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-semibold mb-3">üíª ‡πÇ‡∏Ñ‡πâ‡∏î Google Apps Script</h4>
                    <textarea readonly class="w-full h-64 p-3 border border-gray-300 rounded font-mono text-xs bg-white" onclick="this.select()">
// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç SHEET_ID ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const SHEET_ID = 'YOUR_SHEET_ID_HERE';

function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE
    if (data.action === 'sendLine') {
      return sendLineMessage(data.token, data.userId, data.message);
    }
    
    const sheet = SpreadsheetApp.openById(SHEET_ID).getActiveSheet();
    
    if (data.action === 'write') {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á
      if (sheet.getLastRow() === 0) {
        sheet.getRange(1, 1, 1, 10).setValues([
          ['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°', '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°', '‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô', '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î', '‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à', '‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô', '‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á']
        ]);
        
        // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
        sheet.setColumnWidth(9, 150);  // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô
        sheet.setColumnWidth(10, 150); // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á
      }
      
      // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤ (‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á)
      const lastRow = sheet.getLastRow();
      if (lastRow > 1) {
        sheet.deleteRows(2, lastRow - 1);
      }
      
      // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
      if (data.tasks && data.tasks.length > 0) {
        const rows = data.tasks.map(task => [
          task.date,
          task.time || '',
          task.title,
          task.description || '',
          task.assignee || '',
          task.priority === 'high' ? '‡∏™‡∏π‡∏á' : task.priority === 'medium' ? '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' : '‡∏ï‡πà‡∏≥',
          task.status === 'pending' ? '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' : task.status === 'progress' ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' : '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß',
          task.dueDate || '',
          '', // ‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô - ‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á
          ''  // ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á - ‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á
        ]);
        
        sheet.getRange(2, 1, rows.length, 10).setValues(rows);
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        data.tasks.forEach((task, index) => {
          const rowIndex = index + 2; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2
          
          // ‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
          if (task.beforeImages && task.beforeImages.length > 0) {
            const beforeImageUrls = task.beforeImages.map(img => {
              try {
                const blob = Utilities.newBlob(
                  Utilities.base64Decode(img.data.split(',')[1]), 
                  img.type, 
                  img.name
                );
                const file = DriveApp.createFile(blob);
                file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);
                return `=IMAGE("${file.getDownloadUrl()}")`;
              } catch (error) {
                return `‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ${img.name}`;
              }
            });
            sheet.getRange(rowIndex, 9).setFormula(beforeImageUrls[0]);
            if (beforeImageUrls.length > 1) {
              sheet.getRange(rowIndex, 9).setNote(`‡∏£‡∏π‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${beforeImageUrls.length} ‡∏£‡∏π‡∏õ`);
            }
          }
          
          // ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
          if (task.afterImages && task.afterImages.length > 0) {
            const afterImageUrls = task.afterImages.map(img => {
              try {
                const blob = Utilities.newBlob(
                  Utilities.base64Decode(img.data.split(',')[1]), 
                  img.type, 
                  img.name
                );
                const file = DriveApp.createFile(blob);
                file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);
                return `=IMAGE("${file.getDownloadUrl()}")`;
              } catch (error) {
                return `‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ${img.name}`;
              }
            });
            sheet.getRange(rowIndex, 10).setFormula(afterImageUrls[0]);
            if (afterImageUrls.length > 1) {
              sheet.getRange(rowIndex, 10).setNote(`‡∏£‡∏π‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${afterImageUrls.length} ‡∏£‡∏π‡∏õ`);
            }
          }
        });
        
        // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        if (data.tasks.length > 0) {
          sheet.setRowHeights(2, data.tasks.length, 100);
        }
      }
      
      return ContentService.createTextOutput(JSON.stringify({
        success: true,
        message: `‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó ${data.tasks.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`
      })).setMimeType(ContentService.MimeType.JSON);
    }
    
    if (data.action === 'read') {
      const values = sheet.getDataRange().getValues();
      if (values.length <= 1) {
        return ContentService.createTextOutput(JSON.stringify({
          success: true,
          tasks: []
        })).setMimeType(ContentService.MimeType.JSON);
      }
      
      const headers = values[0];
      const rows = values.slice(1);
      
      const tasks = rows
        .filter(row => row[0] && row[2]) // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô
        .map((row, index) => ({
          id: Date.now() + index,
          date: row[0] ? new Date(row[0]).toISOString().split('T')[0] : '',
          time: row[1] || '',
          title: row[2] || '',
          description: row[3] || '',
          assignee: row[4] || '',
          priority: row[5] === '‡∏™‡∏π‡∏á' ? 'high' : row[5] === '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' ? 'medium' : 'low',
          status: row[6] === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'pending' : row[6] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' ? 'progress' : 'completed',
          dueDate: row[7] ? new Date(row[7]).toISOString().split('T')[0] : '',
          beforeImages: row[8] ? [{name: '‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô', data: row[8], type: 'image/jpeg'}] : [],
          afterImages: row[9] ? [{name: '‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á', data: row[9], type: 'image/jpeg'}] : [],
          createdAt: new Date().toISOString()
        }));
      
      return ContentService.createTextOutput(JSON.stringify({
        success: true,
        tasks: tasks
      })).setMimeType(ContentService.MimeType.JSON);
    }
    
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      success: false,
      error: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE Messaging API
function sendLineMessage(channelAccessToken, userId, message) {
  try {
    const url = 'https://api.line.me/v2/bot/message/push';
    
    const payload = {
      to: userId,
      messages: [{
        type: 'text',
        text: message
      }]
    };
    
    const options = {
      method: 'POST',
      headers: {
        'Authorization': 'Bearer ' + channelAccessToken,
        'Content-Type': 'application/json'
      },
      payload: JSON.stringify(payload)
    };
    
    const response = UrlFetchApp.fetch(url, options);
    const responseCode = response.getResponseCode();
    
    if (responseCode === 200) {
      return ContentService.createTextOutput(JSON.stringify({
        success: true,
        message: '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'
      })).setMimeType(ContentService.MimeType.JSON);
    } else {
      const errorText = response.getContentText();
      let errorMessage = `HTTP ${responseCode}`;
      
      try {
        const errorData = JSON.parse(errorText);
        errorMessage = errorData.message || errorMessage;
      } catch (e) {
        errorMessage = errorText || errorMessage;
      }
      
      return ContentService.createTextOutput(JSON.stringify({
        success: false,
        error: `LINE API Error: ${errorMessage}`
      })).setMimeType(ContentService.MimeType.JSON);
    }
    
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      success: false,
      error: `‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.toString()}`
    })).setMimeType(ContentService.MimeType.JSON);
  }
}
                    </textarea>
                    <p class="text-xs text-gray-600 mt-2">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </div>

                <div class="bg-blue-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏≤ Sheet ID</h4>
                    <p class="text-blue-700 text-sm mb-2">‡∏à‡∏≤‡∏Å URL ‡∏Ç‡∏≠‡∏á Google Sheets:</p>
                    <code class="bg-white p-2 rounded text-xs block">
                        https://docs.google.com/spreadsheets/d/<span class="bg-yellow-200">1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms</span>/edit
                    </code>
                    <p class="text-blue-700 text-sm mt-2">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏Ñ‡∏∑‡∏≠ Sheet ID</p>
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">üì∑ ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</h4>
                    <ul class="text-green-700 space-y-1 text-sm">
                        <li>‚Ä¢ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                        <li>‚Ä¢ ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö IMAGE() function ‡πÉ‡∏ô Google Sheets</li>
                        <li>‚Ä¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ï‡πà‡∏≠‡∏á‡∏≤‡∏ô (‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏£‡∏Å + ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô)</li>
                        <li>‚Ä¢ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</li>
                    </ul>
                </div>

                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á</h4>
                    <ul class="text-yellow-700 space-y-1 text-sm">
                        <li>‚Ä¢ Google Sheets ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ "Anyone with the link" ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ</li>
                        <li>‚Ä¢ Apps Script ‡∏ï‡πâ‡∏≠‡∏á Deploy ‡πÄ‡∏õ‡πá‡∏ô "Web app" ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ "Anyone" ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ</li>
                        <li>‚Ä¢ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Google Sheets ‡πÅ‡∏•‡∏∞ Google Drive</li>
                        <li>‚Ä¢ ‡∏´‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î Apps Script ‡∏ï‡πâ‡∏≠‡∏á Deploy ‡πÉ‡∏´‡∏°‡πà</li>
                        <li>‚Ä¢ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ä‡πâ‡∏≤‡∏•‡∏á</li>
                    </ul>
                </div>

                <div class="bg-red-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-red-800 mb-2">üîß ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</h4>
                    <div class="space-y-3 text-sm">
                        <div class="border-l-4 border-red-500 pl-3">
                            <p class="font-semibold text-red-800">‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Authorization required"</p>
                            <p class="text-red-700">‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏Å‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Google Account ‚Üí ‡∏Å‡∏î "Advanced" ‚Üí "Go to [project name] (unsafe)" ‚Üí "Allow"</p>
                        </div>
                        <div class="border-l-4 border-red-500 pl-3">
                            <p class="font-semibold text-red-800">‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Exception: Invalid argument"</p>
                            <p class="text-red-700">‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SHEET_ID ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ Google Sheets ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ</p>
                        </div>
                        <div class="border-l-4 border-red-500 pl-3">
                            <p class="font-semibold text-red-800">‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Script function not found"</p>
                            <p class="text-red-700">‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏î Save ‡∏Å‡πà‡∏≠‡∏ô Deploy</p>
                        </div>
                        <div class="border-l-4 border-red-500 pl-3">
                            <p class="font-semibold text-red-800">‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Access denied"</p>
                            <p class="text-red-700">‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ "Who has access" ‡πÄ‡∏õ‡πá‡∏ô "Anyone" ‡πÉ‡∏ô Deploy settings</p>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
                    <div class="space-y-2 text-sm">
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Sheet ID ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡πÅ‡∏ä‡∏£‡πå Sheets ‡πÉ‡∏´‡πâ "Anyone with the link" ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script project ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç SHEET_ID ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> Deploy ‡πÄ‡∏õ‡πá‡∏ô Web app (Anyone access) ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                        <label class="flex items-center gap-2 text-green-700">
                            <input type="checkbox" class="rounded"> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Web app URL ‡πÅ‡∏•‡πâ‡∏ß
                        </label>
                    </div>
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Messaging API</h4>
                    <ol class="text-green-700 space-y-1 text-sm">
                        <li>1. ‡πÄ‡∏õ‡∏¥‡∏î <a href="https://developers.line.biz/console/" target="_blank" class="text-blue-600 underline">LINE Developers Console</a></li>
                        <li>2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider ‡πÅ‡∏•‡∏∞ Channel ‡πÉ‡∏´‡∏°‡πà (Messaging API)</li>
                        <li>3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Basic settings ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Channel secret</li>
                        <li>4. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Messaging API ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Channel access token</li>
                        <li>5. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Webhook ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà URL (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)</li>
                        <li>6. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏≤ User ID</li>
                        <li>7. ‡πÉ‡∏™‡πà Channel Access Token ‡πÅ‡∏•‡∏∞ User ID ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
                    </ol>
                    <p class="text-green-700 text-xs mt-2">üí° ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏° ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Group ID ‡πÅ‡∏ó‡∏ô User ID</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div id="taskModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô</h3>
            
            <form id="taskForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô</label>
                    <input type="text" id="taskTitle" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="taskDescription" rows="3" 
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
                        <input type="date" id="taskDate" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
                        <input type="time" id="taskTime" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                        <select id="taskPriority" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="low">‡∏ï‡πà‡∏≥</option>
                            <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                            <option value="high">‡∏™‡∏π‡∏á</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="taskStatus" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="progress">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</option>
                            <option value="completed">‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
                    <select id="taskAssignee" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                    <input type="date" id="taskDueDate" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <input type="file" id="beforeImages" multiple accept="image/*" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <div id="beforeImagePreview" class="image-gallery"></div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <input type="file" id="afterImages" multiple accept="image/*" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <div id="afterImagePreview" class="image-gallery"></div>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                    <button type="button" id="deleteTaskBtn" class="px-4 bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition-colors hidden">
                        ‡∏•‡∏ö
                    </button>
                    <button type="button" id="cancelBtn" class="px-4 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Technician Management Modal -->
    <div id="technicianModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà</label>
                    <div class="flex gap-2">
                        <input type="text" id="newTechnicianName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á" 
                               class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <button id="addTechnicianBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                            ‡πÄ‡∏û‡∏¥‡πà‡∏°
                        </button>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á</label>
                    <div id="technicianList" class="space-y-2 max-h-60 overflow-y-auto">
                        <!-- Technician list will be populated here -->
                    </div>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button id="closeTechnicianModal" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors">
                        ‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div id="imageViewerModal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50 p-4">
        <div class="relative max-w-4xl max-h-full">
            <img id="viewerImage" src="" alt="" class="max-w-full max-h-full object-contain rounded-lg">
            <button id="closeImageViewer" class="absolute top-4 right-4 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-75 transition-colors">
                √ó
            </button>
        </div>
    </div>

    <!-- LINE Bot Setup Modal -->
    <div id="lineBotSetupModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">üì± ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Messaging API</h3>
                <button id="closeLineBotSetupBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">üöÄ ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà</h4>
                    <p class="text-green-700 text-sm mb-2">‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô Google Apps Script</p>
                    <p class="text-green-700 text-sm"><strong>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:</strong> ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô, ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏Å‡∏ß‡πà‡∏≤, ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Rich Message</p>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-3">üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Bot</h4>
                        <ol class="space-y-2 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <span>‡πÄ‡∏õ‡∏¥‡∏î <a href="https://developers.line.biz/console/" target="_blank" class="text-blue-600 underline">LINE Developers Console</a></span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <span>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ LINE</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <span>‡∏Å‡∏î "Create a new provider" (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <span>‡∏Å‡∏î "Create a Messaging API channel"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">5</span>
                                <span>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Channel (‡∏ä‡∏∑‡πà‡∏≠, ‡∏£‡∏π‡∏õ, ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢)</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">6</span>
                                <span>‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Channel</span>
                            </li>
                        </ol>
                    </div>

                    <div>
                        <h4 class="font-semibold mb-3">üîë ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏£‡∏±‡∏ö Access Token</h4>
                        <ol class="space-y-2 text-sm">
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">1</span>
                                <span>‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Channel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">2</span>
                                <span>‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "Messaging API"</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
                                <span><strong>‡∏Å‡∏î "Issue" ‡πÉ‡∏ô Channel access token (long-lived)</strong></span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">4</span>
                                <span><strong>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Token ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏¢‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 100+ ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</strong></span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">5</span>
                                <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô "Use webhooks" (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)</span>
                            </li>
                            <li class="flex gap-2">
                                <span class="bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">6</span>
                                <span>‡∏õ‡∏¥‡∏î "Auto-reply messages" ‡πÅ‡∏•‡∏∞ "Greeting messages"</span>
                            </li>
                        </ol>
                        <div class="mt-3 p-3 bg-red-100 rounded border-l-4 border-red-500">
                            <p class="text-red-800 text-sm font-semibold">üö® ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î 401:</p>
                            <p class="text-red-800 text-sm">‚Ä¢ <strong>‡πÉ‡∏ä‡πâ "Channel Access Token" (‡∏¢‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 100+ ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</strong></p>
                            <p class="text-red-800 text-sm">‚Ä¢ <strong>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "Channel Secret" (‡∏™‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</strong></p>
                            <p class="text-red-800 text-sm">‚Ä¢ ‡∏Å‡∏î "Issue" ‡πÉ‡∏ô Channel access token (long-lived)</p>
                            <p class="text-red-800 text-sm">‚Ä¢ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Token: "O3RHKsAexjFC3xrtWQzf/RgIn29svznPi8xyv0nC1PR..."</p>
                            <p class="text-red-800 text-sm">‚Ä¢ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á User ID: "Uc8c00fd05b1af0c34351d1629b453666"</p>
                            <p class="text-red-800 text-sm">‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß</p>
                        </div>
                    </div>
                </div>

                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">üë§ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏´‡∏≤ User ID</h4>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <h5 class="font-medium text-yellow-700 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ QR Code</h5>
                            <ol class="text-yellow-700 space-y-1 text-sm">
                                <li>1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "Messaging API"</li>
                                <li>2. ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏≠‡∏õ LINE</li>
                                <li>3. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</li>
                                <li>4. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏ó</li>
                                <li>5. ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ Get User ID</li>
                            </ol>
                        </div>
                        <div>
                            <h5 class="font-medium text-yellow-700 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ Webhook</h5>
                            <ol class="text-yellow-700 space-y-1 text-sm">
                                <li>1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook URL</li>
                                <li>2. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏ó</li>
                                <li>3. ‡∏î‡∏π User ID ‡πÉ‡∏ô Webhook event</li>
                                <li>4. ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-semibold mb-3">üõ†Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏´‡∏≤ User ID</h4>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded border">
                            <h5 class="font-medium mb-2">üì± LINE User ID Finder (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)</h5>
                            <p class="text-sm text-gray-600 mb-2">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤ User ID</p>
                            <a href="https://line-user-id-finder.vercel.app/" target="_blank" class="text-blue-600 underline text-sm">
                                line-user-id-finder.vercel.app
                            </a>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <h5 class="font-medium mb-2">üîß Webhook Tester</h5>
                            <p class="text-sm text-gray-600 mb-2">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook ‡πÅ‡∏•‡∏∞‡∏î‡∏π Event ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</p>
                            <a href="https://webhook.site/" target="_blank" class="text-blue-600 underline text-sm">
                                webhook.site
                            </a>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-green-800 mb-2">üìã ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏° LINE</h4>
                    <ol class="text-green-700 space-y-1 text-sm">
                        <li>1. ‡πÄ‡∏ä‡∏¥‡∏ç‡∏ö‡∏≠‡∏ó‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° LINE</li>
                        <li>2. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° (‡πÅ‡∏ó‡πá‡∏Å‡∏ö‡∏≠‡∏ó)</li>
                        <li>3. ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏´‡∏≤ Group ID</li>
                        <li>4. Group ID ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ "C" ‡πÅ‡∏ó‡∏ô "U"</li>
                    </ol>
                </div>

                <div class="bg-red-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-red-800 mb-2">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á</h4>
                    <ul class="text-red-700 space-y-1 text-sm">
                        <li>‚Ä¢ Channel Access Token ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</li>
                        <li>‚Ä¢ Token ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞</li>
                        <li>‚Ä¢ ‡∏ö‡∏≠‡∏ó‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ</li>
                        <li>‚Ä¢ ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏° LINE Policy</li>
                        <li>‚Ä¢ ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</li>
                    </ul>
                </div>

                <div class="bg-blue-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">üí° ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h4>
                    <ul class="text-blue-700 space-y-1 text-sm">
                        <li>‚Ä¢ ‡πÉ‡∏ä‡πâ Rich Message ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°</li>
                        <li>‚Ä¢ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Quick Reply ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢</li>
                        <li>‚Ä¢ ‡πÉ‡∏ä‡πâ Flex Message ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏¢‡πå‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô</li>
                        <li>‚Ä¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û, ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ</li>
                        <li>‚Ä¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Push Message ‡πÅ‡∏•‡∏∞ Reply Message</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TaskScheduler {
            constructor() {
                // üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                // ========================================
                
                // üìä Google Apps Script URL (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏±‡∏ö Google Sheets)
                // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£: ‡πÑ‡∏õ‡∏ó‡∏µ‡πà script.google.com ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á project ‡πÉ‡∏´‡∏°‡πà ‚Üí Deploy ‡πÄ‡∏õ‡πá‡∏ô Web app
                this.DEFAULT_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzuGe1c35Rs7uklLHySZH_u8evPcp3otFWB4TA5G0Egw5rx8qtD8CG7so6EvzpEkMXU/exec';
                
                // üì± LINE Bot Configuration (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)
                // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£: ‡πÑ‡∏õ‡∏ó‡∏µ‡πà developers.line.biz ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á Messaging API Channel
                this.DEFAULT_LINE_CHANNEL_ACCESS_TOKEN = 'Fvv/+EW2OR5y18NHCBSdvkcoea4ZpiUBb64CPaD0tFAj+OTV5zPKn7VbDtT1q6Gy98HcBRE1By40/CkxCylfdwIvow/bsmlXWw6Slu8tK7MxdRldqcPOE87iNLTNFe4HfGaY/7ripZul4mUXEvVEXAdB04t89/1O/w1cDnyilFU=';
                this.DEFAULT_LINE_USER_ID = 'Uc8c00fd05b1af0c34351d1629b453666'; // User ID ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß
                
                // üöÄ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (true = ‡πÄ‡∏õ‡∏¥‡∏î, false = ‡∏õ‡∏¥‡∏î)
                this.DEFAULT_AUTO_SYNC = true;
                this.DEFAULT_LINE_NOTIFY = true;
                
                // ========================================
                // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
                // ========================================
                
                this.currentDate = new Date();
                this.tasks = JSON.parse(localStorage.getItem('schedulerTasks')) || [];
                this.technicians = JSON.parse(localStorage.getItem('schedulerTechnicians')) || ['‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ä‡∏≤‡∏¢', '‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏ô‡∏∞'];
                this.currentEditingTask = null;
                this.syncStatus = 'offline';
                this.autoSyncEnabled = false;
                this.syncInterval = null;
                this.notifications = [];
                this.notificationCheckInterval = null;
                this.lineNotifyEnabled = false;
                this.lineChannelAccessToken = '';
                this.lineUserId = '';
                
                this.initializeElements();
                this.bindEvents();
                this.loadSavedConfig();
                this.renderCalendar();
                this.updateStats();
                this.updateSyncIndicator();
                this.updateTechnicianOptions();
                this.startAutoSync();
                this.startNotificationCheck();
            }
            
            initializeElements() {
                this.calendarDays = document.getElementById('calendarDays');
                this.currentMonthEl = document.getElementById('currentMonth');
                this.taskModal = document.getElementById('taskModal');
                this.taskForm = document.getElementById('taskForm');
                this.syncIndicator = document.getElementById('syncIndicator');
            }
            
            bindEvents() {
                // Navigation
                document.getElementById('prevMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });
                
                document.getElementById('nextMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });
                
                // Modal controls
                document.getElementById('addTaskBtn').addEventListener('click', () => this.openTaskModal());
                document.getElementById('cancelBtn').addEventListener('click', () => this.closeTaskModal());
                document.getElementById('deleteTaskBtn').addEventListener('click', () => this.deleteTask());
                
                // Form submission
                this.taskForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveTask();
                });
                
                // Sync controls
                document.getElementById('forceSyncBtn').addEventListener('click', () => this.forceSync());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
                document.getElementById('setupGuideBtn').addEventListener('click', () => this.openSetupGuide());
                document.getElementById('closeGuideBtn').addEventListener('click', () => this.closeSetupGuide());
                document.getElementById('testConnectionBtn').addEventListener('click', () => this.testConnection());
                document.getElementById('syncToSheetBtn').addEventListener('click', () => this.syncToSheet());
                document.getElementById('syncFromSheetBtn').addEventListener('click', () => this.syncFromSheet());
                
                // Auto sync toggle
                document.getElementById('autoSync').addEventListener('change', (e) => {
                    this.autoSyncEnabled = e.target.checked;
                    this.saveConfig();
                    if (this.autoSyncEnabled) {
                        this.startAutoSync();
                    } else {
                        this.stopAutoSync();
                    }
                });
                
                // Apps Script URL change
                document.getElementById('appsScriptUrl').addEventListener('change', () => {
                    this.saveConfig();
                });

                // LINE Bot controls
                document.getElementById('testLineBtn').addEventListener('click', () => this.testLineBot());
                document.getElementById('lineSetupBtn').addEventListener('click', () => this.openLineBotSetup());
                document.getElementById('closeLineBotSetupBtn').addEventListener('click', () => this.closeLineBotSetup());
                document.getElementById('enableLineNotify').addEventListener('change', (e) => {
                    this.lineNotifyEnabled = e.target.checked;
                    this.saveConfig();
                });
                document.getElementById('lineChannelAccessToken').addEventListener('change', () => {
                    this.saveConfig();
                });
                document.getElementById('lineUserId').addEventListener('change', () => {
                    this.saveConfig();
                });

                // Notification controls
                document.getElementById('notificationBell').addEventListener('click', () => this.toggleNotificationPanel());
                document.getElementById('closeNotifications').addEventListener('click', () => this.closeNotificationPanel());

                // Technician management
                document.getElementById('manageTechniciansBtn').addEventListener('click', () => this.openTechnicianModal());
                document.getElementById('closeTechnicianModal').addEventListener('click', () => this.closeTechnicianModal());
                document.getElementById('addTechnicianBtn').addEventListener('click', () => this.addTechnician());
                document.getElementById('newTechnicianName').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addTechnician();
                });

                // Image handling
                document.getElementById('beforeImages').addEventListener('change', (e) => this.handleImageUpload(e, 'before'));
                document.getElementById('afterImages').addEventListener('change', (e) => this.handleImageUpload(e, 'after'));
                document.getElementById('closeImageViewer').addEventListener('click', () => this.closeImageViewer());
                
                // Close modals on outside click
                this.taskModal.addEventListener('click', (e) => {
                    if (e.target === this.taskModal) this.closeTaskModal();
                });

                document.getElementById('technicianModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('technicianModal')) this.closeTechnicianModal();
                });

                document.getElementById('imageViewerModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('imageViewerModal')) this.closeImageViewer();
                });

                document.getElementById('lineBotSetupModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('lineBotSetupModal')) this.closeLineBotSetup();
                });
            }
            
            renderCalendar() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // Update month display
                const monthNames = [
                    '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                    '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
                ];
                this.currentMonthEl.textContent = `${monthNames[month]} ${year + 543}`;
                
                // Calculate calendar days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());
                
                // Clear calendar
                this.calendarDays.innerHTML = '';
                
                // Generate calendar days
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    const dayEl = this.createDayElement(date, month);
                    this.calendarDays.appendChild(dayEl);
                }
            }
            
            createDayElement(date, currentMonth) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                
                const isCurrentMonth = date.getMonth() === currentMonth;
                const isToday = this.isToday(date);
                
                if (!isCurrentMonth) {
                    dayEl.classList.add('opacity-30');
                }
                
                if (isToday) {
                    dayEl.classList.add('bg-blue-50', 'border-2', 'border-blue-300');
                }
                
                // Day number
                const dayNumber = document.createElement('div');
                dayNumber.className = `text-sm font-semibold mb-1 ${isToday ? 'text-blue-600' : 'text-gray-700'}`;
                dayNumber.textContent = date.getDate();
                dayEl.appendChild(dayNumber);
                
                // Add tasks for this day
                const dayTasks = this.getTasksForDate(date);
                dayTasks.forEach(task => {
                    const taskEl = this.createTaskElement(task);
                    dayEl.appendChild(taskEl);
                });
                
                // Add click handler for adding tasks
                dayEl.addEventListener('click', (e) => {
                    if (e.target === dayEl || e.target === dayNumber) {
                        this.openTaskModal(date);
                    }
                });
                
                return dayEl;
            }
            
            createTaskElement(task) {
                const taskEl = document.createElement('div');
                let taskClass = `task-item priority-${task.priority} status-${task.status}`;
                
                // Check if task is overdue or due soon
                if (task.dueDate) {
                    const today = new Date();
                    const dueDate = new Date(task.dueDate);
                    const diffTime = dueDate - today;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays < 0 && task.status !== 'completed') {
                        taskClass += ' overdue-task';
                    } else if (diffDays <= 2 && diffDays >= 0 && task.status !== 'completed') {
                        taskClass += ' due-soon-task';
                    }
                }
                
                taskEl.className = taskClass;
                
                const time = task.time ? ` ${task.time}` : '';
                const dueDate = task.dueDate ? ` üìÖ ${task.dueDate}` : '';
                const hasImages = (task.beforeImages && task.beforeImages.length > 0) || (task.afterImages && task.afterImages.length > 0);
                
                taskEl.innerHTML = `
                    <div class="font-medium truncate">${task.title}</div>
                    ${time ? `<div class="text-xs opacity-75">‚è∞ ${time}</div>` : ''}
                    ${task.assignee ? `<div class="text-xs opacity-75">üë§ ${task.assignee}</div>` : ''}
                    ${dueDate ? `<div class="text-xs opacity-75">${dueDate}</div>` : ''}
                    ${hasImages ? `<div class="text-xs opacity-75">üì∑ ‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>` : ''}
                `;
                
                // Add event listener for editing task
                taskEl.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.editTask(task);
                });
                
                return taskEl;
            }
            
            getTasksForDate(date) {
                const dateStr = this.formatDate(date);
                return this.tasks.filter(task => task.date === dateStr);
            }
            
            isToday(date) {
                const today = new Date();
                return date.toDateString() === today.toDateString();
            }
            
            formatDate(date) {
                return date.toISOString().split('T')[0];
            }
            
            openTaskModal(date = null) {
                this.currentEditingTask = null;
                this.taskForm.reset();
                
                // Set current date and time
                const now = new Date();
                const currentDate = date ? this.formatDate(date) : this.formatDate(now);
                const currentTime = now.toTimeString().slice(0, 5);
                
                document.getElementById('taskDate').value = currentDate;
                document.getElementById('taskTime').value = currentTime;
                
                document.getElementById('deleteTaskBtn').classList.add('hidden');
                this.taskModal.classList.remove('hidden');
                this.taskModal.classList.add('flex');
                
                setTimeout(() => {
                    document.getElementById('taskTitle').focus();
                }, 100);
            }
            
            editTask(task) {
                this.currentEditingTask = task;
                
                // Populate form
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description || '';
                document.getElementById('taskDate').value = task.date;
                document.getElementById('taskTime').value = task.time || '';
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskStatus').value = task.status;
                document.getElementById('taskAssignee').value = task.assignee || '';
                document.getElementById('taskDueDate').value = task.dueDate || '';
                
                // Display existing images
                this.displayExistingImages('before', task.beforeImages || []);
                this.displayExistingImages('after', task.afterImages || []);
                
                document.getElementById('deleteTaskBtn').classList.remove('hidden');
                this.taskModal.classList.remove('hidden');
                this.taskModal.classList.add('flex');
            }
            
            closeTaskModal() {
                this.taskModal.classList.add('hidden');
                this.taskModal.classList.remove('flex');
                this.currentEditingTask = null;
            }
            
            async saveTask() {
                const taskData = {
                    id: this.currentEditingTask ? this.currentEditingTask.id : Date.now(),
                    title: document.getElementById('taskTitle').value,
                    description: document.getElementById('taskDescription').value,
                    date: document.getElementById('taskDate').value,
                    time: document.getElementById('taskTime').value,
                    priority: document.getElementById('taskPriority').value,
                    status: document.getElementById('taskStatus').value,
                    assignee: document.getElementById('taskAssignee').value,
                    dueDate: document.getElementById('taskDueDate').value,
                    beforeImages: this.currentEditingTask ? this.currentEditingTask.beforeImages || [] : [],
                    afterImages: this.currentEditingTask ? this.currentEditingTask.afterImages || [] : [],
                    createdAt: this.currentEditingTask ? this.currentEditingTask.createdAt : new Date().toISOString()
                };

                // Handle new image uploads
                const beforeFiles = document.getElementById('beforeImages').files;
                const afterFiles = document.getElementById('afterImages').files;

                if (beforeFiles.length > 0) {
                    taskData.beforeImages = await this.processImageFiles(beforeFiles);
                }

                if (afterFiles.length > 0) {
                    taskData.afterImages = await this.processImageFiles(afterFiles);
                }

                // Check for status change to send LINE notification
                let statusChanged = false;
                let oldStatus = '';
                let newStatus = taskData.status;
                
                if (this.currentEditingTask) {
                    oldStatus = this.currentEditingTask.status;
                    statusChanged = oldStatus !== newStatus;
                    const index = this.tasks.findIndex(t => t.id === this.currentEditingTask.id);
                    this.tasks[index] = taskData;
                } else {
                    this.tasks.push(taskData);
                    statusChanged = true; // New task created
                    oldStatus = 'new';
                }
                
                this.saveTasks();
                this.renderCalendar();
                this.updateStats();
                this.closeTaskModal();

                // Send LINE notification if status changed
                if (statusChanged && this.lineNotifyEnabled) {
                    await this.sendStatusChangeNotification(taskData, oldStatus, newStatus);
                }
                
                // Auto sync if enabled
                if (this.autoSyncEnabled) {
                    await this.syncToSheet();
                }
            }
            
            async deleteTask() {
                if (this.currentEditingTask && confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    this.tasks = this.tasks.filter(t => t.id !== this.currentEditingTask.id);
                    this.saveTasks();
                    this.renderCalendar();
                    this.updateStats();
                    this.closeTaskModal();
                    
                    if (this.autoSyncEnabled) {
                        await this.syncToSheet();
                    }
                }
            }
            
            saveTasks() {
                localStorage.setItem('schedulerTasks', JSON.stringify(this.tasks));
            }
            
            updateStats() {
                const total = this.tasks.length;
                const pending = this.tasks.filter(t => t.status === 'pending').length;
                const completed = this.tasks.filter(t => t.status === 'completed').length;
                const high = this.tasks.filter(t => t.priority === 'high').length;
                const medium = this.tasks.filter(t => t.priority === 'medium').length;
                const low = this.tasks.filter(t => t.priority === 'low').length;
                
                document.getElementById('totalTasks').textContent = total;
                document.getElementById('pendingTasks').textContent = pending;
                document.getElementById('completedTasks').textContent = completed;
                document.getElementById('highPriority').textContent = high;
                document.getElementById('mediumPriority').textContent = medium;
                document.getElementById('lowPriority').textContent = low;
            }
            
            updateSyncIndicator() {
                const indicator = this.syncIndicator;
                indicator.className = 'sync-indicator';
                
                switch (this.syncStatus) {
                    case 'online':
                        indicator.classList.add('sync-online');
                        indicator.textContent = 'üü¢ ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå';
                        break;
                    case 'syncing':
                        indicator.classList.add('sync-syncing');
                        indicator.textContent = 'üü° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå...';
                        break;
                    default:
                        indicator.classList.add('sync-offline');
                        indicator.textContent = 'üî¥ ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå';
                }
            }
            
            async testConnection() {
                const url = document.getElementById('appsScriptUrl').value.trim() || this.DEFAULT_APPS_SCRIPT_URL;
                
                if (!url || url.includes('YOUR_SCRIPT_ID_HERE')) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Apps Script URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î', 'warning');
                    return;
                }
                
                const testBtn = document.getElementById('testConnectionBtn');
                const originalText = testBtn.textContent;
                testBtn.textContent = 'üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                testBtn.disabled = true;
                
                try {
                    this.syncStatus = 'syncing';
                    this.updateSyncIndicator();
                    
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'text/plain',
                        },
                        body: JSON.stringify({
                            action: 'read'
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        this.syncStatus = 'online';
                        this.showMessage('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'success');
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                } catch (error) {
                    this.syncStatus = 'offline';
                    this.showMessage(`‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, 'error');
                } finally {
                    this.updateSyncIndicator();
                    testBtn.textContent = originalText;
                    testBtn.disabled = false;
                }
            }
            
            async syncToSheet() {
                const url = document.getElementById('appsScriptUrl').value.trim() || this.DEFAULT_APPS_SCRIPT_URL;
                
                if (!url || url.includes('YOUR_SCRIPT_ID_HERE')) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Apps Script URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î', 'warning');
                    return;
                }
                
                try {
                    this.syncStatus = 'syncing';
                    this.updateSyncIndicator();
                    
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'text/plain',
                        },
                        body: JSON.stringify({
                            action: 'write',
                            tasks: this.tasks
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            this.syncStatus = 'online';
                            this.showMessage('‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                        } else {
                            throw new Error(result.error || '‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß');
                        }
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                } catch (error) {
                    this.syncStatus = 'offline';
                    this.showMessage(`‚ùå ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, 'error');
                } finally {
                    this.updateSyncIndicator();
                }
            }
            
            async syncFromSheet() {
                const url = document.getElementById('appsScriptUrl').value.trim() || this.DEFAULT_APPS_SCRIPT_URL;
                
                if (!url || url.includes('YOUR_SCRIPT_ID_HERE')) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Apps Script URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î', 'warning');
                    return;
                }
                
                try {
                    this.syncStatus = 'syncing';
                    this.updateSyncIndicator();
                    
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'text/plain',
                        },
                        body: JSON.stringify({
                            action: 'read'
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            this.tasks = result.tasks || [];
                            this.saveTasks();
                            this.renderCalendar();
                            this.updateStats();
                            this.syncStatus = 'online';
                            this.showMessage(`‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (${this.tasks.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`, 'success');
                        } else {
                            throw new Error(result.error || '‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß');
                        }
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                } catch (error) {
                    this.syncStatus = 'offline';
                    this.showMessage(`‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, 'error');
                } finally {
                    this.updateSyncIndicator();
                }
            }
            
            async forceSync() {
                if (this.autoSyncEnabled) {
                    await this.syncToSheet();
                } else {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                }
            }
            
            exportData() {
                const dataStr = JSON.stringify(this.tasks, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                
                this.showMessage('‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
            
            openSetupGuide() {
                document.getElementById('setupGuideModal').classList.remove('hidden');
                document.getElementById('setupGuideModal').classList.add('flex');
            }
            
            closeSetupGuide() {
                document.getElementById('setupGuideModal').classList.add('hidden');
                document.getElementById('setupGuideModal').classList.remove('flex');
            }
            
            startAutoSync() {
                if (this.autoSyncEnabled && !this.syncInterval) {
                    // Sync every 5 minutes
                    this.syncInterval = setInterval(async () => {
                        const url = document.getElementById('appsScriptUrl').value.trim() || this.DEFAULT_APPS_SCRIPT_URL;
                        if (url && !url.includes('YOUR_SCRIPT_ID_HERE')) {
                            await this.syncToSheet();
                        }
                    }, 5 * 60 * 1000);
                }
            }
            
            stopAutoSync() {
                if (this.syncInterval) {
                    clearInterval(this.syncInterval);
                    this.syncInterval = null;
                }
            }
            
            loadSavedConfig() {
                const config = JSON.parse(localStorage.getItem('schedulerConfig')) || {};
                
                // ‡∏ù‡∏±‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏≠‡∏á!
                const defaultConfig = {
                    appsScriptUrl: this.DEFAULT_APPS_SCRIPT_URL,
                    autoSync: this.DEFAULT_AUTO_SYNC,
                    lineChannelAccessToken: this.DEFAULT_LINE_CHANNEL_ACCESS_TOKEN,
                    lineUserId: this.DEFAULT_LINE_USER_ID,
                    lineNotifyEnabled: this.DEFAULT_LINE_NOTIFY
                };
                
                // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                const finalConfig = { ...defaultConfig, ...config };
                
                document.getElementById('appsScriptUrl').value = finalConfig.appsScriptUrl;
                document.getElementById('autoSync').checked = finalConfig.autoSync;
                this.autoSyncEnabled = finalConfig.autoSync;

                document.getElementById('lineChannelAccessToken').value = finalConfig.lineChannelAccessToken;
                this.lineChannelAccessToken = finalConfig.lineChannelAccessToken;

                document.getElementById('lineUserId').value = finalConfig.lineUserId;
                this.lineUserId = finalConfig.lineUserId;

                document.getElementById('enableLineNotify').checked = finalConfig.lineNotifyEnabled;
                this.lineNotifyEnabled = finalConfig.lineNotifyEnabled;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                if (finalConfig.appsScriptUrl.includes('YOUR_SCRIPT_ID_HERE')) {
                    this.showMessage('üí° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Apps Script URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î', 'warning');
                }
                
                if (finalConfig.lineChannelAccessToken.includes('YOUR_LINE_CHANNEL_ACCESS_TOKEN_HERE')) {
                    this.showMessage('üí° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç LINE Channel Access Token ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î', 'warning');
                }
            }
            
            saveConfig() {
                const config = {
                    appsScriptUrl: document.getElementById('appsScriptUrl').value,
                    autoSync: document.getElementById('autoSync').checked,
                    lineChannelAccessToken: document.getElementById('lineChannelAccessToken').value,
                    lineUserId: document.getElementById('lineUserId').value,
                    lineNotifyEnabled: document.getElementById('enableLineNotify').checked
                };
                
                this.lineChannelAccessToken = config.lineChannelAccessToken;
                this.lineUserId = config.lineUserId;
                this.lineNotifyEnabled = config.lineNotifyEnabled;
                
                localStorage.setItem('schedulerConfig', JSON.stringify(config));
            }
            
            // Notification functions
            startNotificationCheck() {
                this.checkNotifications();
                this.notificationCheckInterval = setInterval(() => {
                    this.checkNotifications();
                }, 60000); // Check every minute

                // Send LINE notifications for due dates (check every hour)
                this.sendDueDateNotifications();
                setInterval(() => {
                    this.sendDueDateNotifications();
                }, 60 * 60 * 1000); // Check every hour
            }

            checkNotifications() {
                const today = new Date();
                const notifications = [];

                this.tasks.forEach(task => {
                    if (task.dueDate && task.status !== 'completed') {
                        const dueDate = new Date(task.dueDate);
                        const diffTime = dueDate - today;
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                        if (diffDays < 0) {
                            notifications.push({
                                id: `overdue-${task.id}`,
                                type: 'overdue',
                                task: task,
                                message: `‡∏á‡∏≤‡∏ô "${task.title}" ‡πÄ‡∏•‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß ${Math.abs(diffDays)} ‡∏ß‡∏±‡∏ô`,
                                priority: 'high'
                            });
                        } else if (diffDays <= 2) {
                            notifications.push({
                                id: `due-soon-${task.id}`,
                                type: 'due-soon',
                                task: task,
                                message: `‡∏á‡∏≤‡∏ô "${task.title}" ‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (${diffDays} ‡∏ß‡∏±‡∏ô)`,
                                priority: 'medium'
                            });
                        }
                    }
                });

                this.notifications = notifications;
                this.updateNotificationBadge();
            }

            updateNotificationBadge() {
                const badge = document.getElementById('notificationBadge');
                const count = this.notifications.length;

                if (count > 0) {
                    badge.textContent = count;
                    badge.classList.remove('hidden');
                } else {
                    badge.classList.add('hidden');
                }
            }

            toggleNotificationPanel() {
                const panel = document.getElementById('notificationPanel');
                panel.classList.toggle('show');
                
                if (panel.classList.contains('show')) {
                    this.renderNotifications();
                }
            }

            closeNotificationPanel() {
                document.getElementById('notificationPanel').classList.remove('show');
            }

            renderNotifications() {
                const list = document.getElementById('notificationList');
                
                if (this.notifications.length === 0) {
                    list.innerHTML = '<div class="p-4 text-center text-gray-500 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>';
                    return;
                }

                list.innerHTML = this.notifications.map(notification => `
                    <div class="notification-item ${notification.type}" onclick="scheduler.openTaskFromNotification('${notification.task.id}')">
                        <div class="font-medium text-sm">${notification.message}</div>
                        <div class="text-xs text-gray-600 mt-1">
                            üë§ ${notification.task.assignee || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} | 
                            üìÖ ${notification.task.dueDate}
                        </div>
                    </div>
                `).join('');
            }

            openTaskFromNotification(taskId) {
                const task = this.tasks.find(t => t.id == taskId);
                if (task) {
                    this.editTask(task);
                    this.closeNotificationPanel();
                }
            }

            // Technician management functions
            openTechnicianModal() {
                this.renderTechnicianList();
                document.getElementById('technicianModal').classList.remove('hidden');
                document.getElementById('technicianModal').classList.add('flex');
            }

            closeTechnicianModal() {
                document.getElementById('technicianModal').classList.add('hidden');
                document.getElementById('technicianModal').classList.remove('flex');
            }

            addTechnician() {
                const name = document.getElementById('newTechnicianName').value.trim();
                if (name && !this.technicians.includes(name)) {
                    this.technicians.push(name);
                    this.saveTechnicians();
                    this.updateTechnicianOptions();
                    this.renderTechnicianList();
                    document.getElementById('newTechnicianName').value = '';
                    this.showMessage(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≤‡∏á "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`, 'success');
                } else if (this.technicians.includes(name)) {
                    this.showMessage('‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß', 'warning');
                } else {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á', 'warning');
                }
            }

            removeTechnician(name) {
                if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ä‡πà‡∏≤‡∏á "${name}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                    this.technicians = this.technicians.filter(t => t !== name);
                    this.saveTechnicians();
                    this.updateTechnicianOptions();
                    this.renderTechnicianList();
                    this.showMessage(`‡∏•‡∏ö‡∏ä‡πà‡∏≤‡∏á "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`, 'success');
                }
            }

            renderTechnicianList() {
                const list = document.getElementById('technicianList');
                list.innerHTML = this.technicians.map(name => `
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                        <span class="text-sm">${name}</span>
                        <button onclick="scheduler.removeTechnician('${name}')" 
                                class="text-red-500 hover:text-red-700 text-sm">‡∏•‡∏ö</button>
                    </div>
                `).join('');
            }

            updateTechnicianOptions() {
                const select = document.getElementById('taskAssignee');
                const currentValue = select.value;
                
                select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á</option>' +
                    this.technicians.map(name => `<option value="${name}">${name}</option>`).join('');
                
                if (currentValue && this.technicians.includes(currentValue)) {
                    select.value = currentValue;
                }
            }

            saveTechnicians() {
                localStorage.setItem('schedulerTechnicians', JSON.stringify(this.technicians));
            }

            // Image handling functions
            async handleImageUpload(event, type) {
                const files = event.target.files;
                if (files.length > 0) {
                    const previewContainer = document.getElementById(`${type}ImagePreview`);
                    previewContainer.innerHTML = '';
                    
                    for (let file of files) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'image-preview';
                            img.onclick = () => this.openImageViewer(e.target.result);
                            previewContainer.appendChild(img);
                        };
                        reader.readAsDataURL(file);
                    }
                }
            }

            async processImageFiles(files) {
                const images = [];
                for (let file of files) {
                    const base64 = await this.fileToBase64(file);
                    images.push({
                        name: file.name,
                        data: base64,
                        size: file.size,
                        type: file.type
                    });
                }
                return images;
            }

            fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                });
            }

            displayExistingImages(type, images) {
                const previewContainer = document.getElementById(`${type}ImagePreview`);
                previewContainer.innerHTML = '';
                
                if (images && images.length > 0) {
                    images.forEach(image => {
                        const img = document.createElement('img');
                        img.src = image.data;
                        img.className = 'image-preview';
                        img.onclick = () => this.openImageViewer(image.data);
                        previewContainer.appendChild(img);
                    });
                }
            }

            openImageViewer(imageSrc) {
                document.getElementById('viewerImage').src = imageSrc;
                document.getElementById('imageViewerModal').classList.remove('hidden');
                document.getElementById('imageViewerModal').classList.add('flex');
            }

            closeImageViewer() {
                document.getElementById('imageViewerModal').classList.add('hidden');
                document.getElementById('imageViewerModal').classList.remove('flex');
            }

            // LINE Bot Setup Modal functions
            openLineBotSetup() {
                document.getElementById('lineBotSetupModal').classList.remove('hidden');
                document.getElementById('lineBotSetupModal').classList.add('flex');
            }

            closeLineBotSetup() {
                document.getElementById('lineBotSetupModal').classList.add('hidden');
                document.getElementById('lineBotSetupModal').classList.remove('flex');
            }

            // LINE Bot functions
            async sendLineMessage(message) {
                // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                const token = document.getElementById('lineChannelAccessToken').value.trim();
                const userId = document.getElementById('lineUserId').value.trim();
                const enabled = document.getElementById('enableLineNotify').checked;

                if (!token || !userId || !enabled) {
                    return false;
                }

                try {
                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE Messaging API
                    const response = await fetch('https://api.line.me/v2/bot/message/push', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            to: userId,
                            messages: [{
                                type: 'text',
                                text: message
                            }]
                        })
                    });

                    if (response.ok) {
                        return true;
                    } else {
                        const errorData = await response.json().catch(() => ({}));
                        console.error('LINE API Error:', response.status, errorData);
                        return false;
                    }
                } catch (error) {
                    console.error('LINE Bot error:', error);
                    return false;
                }
            }

            async testLineBot() {
                const token = document.getElementById('lineChannelAccessToken').value.trim();
                const userId = document.getElementById('lineUserId').value.trim();
                
                if (!token) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Channel Access Token', 'warning');
                    return;
                }

                if (!userId) {
                    this.showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà User ID ‡∏´‡∏£‡∏∑‡∏≠ Group ID', 'warning');
                    return;
                }

                const testBtn = document.getElementById('testLineBtn');
                const originalText = testBtn.textContent;
                testBtn.textContent = 'üì± ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                testBtn.disabled = true;

                try {
                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE Messaging API
                    const response = await fetch('https://api.line.me/v2/bot/message/push', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            to: userId,
                            messages: [{
                                type: 'text',
                                text: 'üîß ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á\n‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!'
                            }]
                        })
                    });

                    if (response.ok) {
                        this.showMessage('‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    } else {
                        const errorData = await response.json().catch(() => ({}));
                        let errorMsg = `HTTP ${response.status}`;
                        
                        if (errorData.message) {
                            errorMsg += `: ${errorData.message}`;
                        }
                        
                        throw new Error(errorMsg);
                    }
                } catch (error) {
                    let errorMsg = error.message;
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î 401 Authentication failed
                    if (errorMsg.includes('401') || errorMsg.includes('Authentication failed')) {
                        errorMsg = 'üö® ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î 401: Token ‡∏´‡∏£‡∏∑‡∏≠ User ID ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                        this.showMessage(errorMsg, 'error');
                        
                        setTimeout(() => {
                            this.showMessage('üîß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:\n1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Channel Access Token ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö User ID ‡∏´‡∏£‡∏∑‡∏≠ Group ID\n3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß', 'warning');
                        }, 1500);
                        
                        setTimeout(() => {
                            this.showMessage('üí° Token ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÜ ‡πÄ‡∏ä‡πà‡∏ô "O3RHKsAexjFC3xrtWQzf/RgIn29svznPi8xyv0nC1PR..." (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 100+ ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)', 'info');
                        }, 3000);
                    } else if (errorMsg.includes('403')) {
                        this.showMessage('üö® ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î 403: ‡∏ö‡∏≠‡∏ó‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß\n‚Ä¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏≠‡∏ó‡∏ñ‡∏π‡∏Å‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß', 'error');
                    } else if (errorMsg.includes('400')) {
                        this.showMessage('üö® ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î 400: User ID ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö User ID ‡∏´‡∏£‡∏∑‡∏≠ Group ID ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                    } else {
                        this.showMessage(`‚ùå ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${errorMsg}`, 'error');
                        
                        setTimeout(() => {
                            this.showMessage('üí° ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: 1) Token ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 2) User ID ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 3) ‡∏ö‡∏≠‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß 4) ‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï', 'info');
                        }, 2000);
                    }
                } finally {
                    testBtn.textContent = originalText;
                    testBtn.disabled = false;
                }
            }

            async sendStatusChangeNotification(task, oldStatus, newStatus) {
                const statusText = {
                    'new': '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà',
                    'pending': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    'progress': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥',
                    'completed': '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß'
                };

                const priorityText = {
                    'high': '‡∏™‡∏π‡∏á üî¥',
                    'medium': '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á üü°',
                    'low': '‡∏ï‡πà‡∏≥ üü¢'
                };

                let message = '';
                
                if (oldStatus === 'new') {
                    message = `üÜï ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà: ${task.title}\n`;
                } else {
                    message = `üîÑ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô: ${task.title}\n`;
                    message += `üìã ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å: ${statusText[oldStatus]} ‚Üí ${statusText[newStatus]}\n`;
                }

                message += `üë§ ‡∏ä‡πà‡∏≤‡∏á: ${task.assignee || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\n`;
                message += `üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${task.date}`;
                
                if (task.time) {
                    message += ` ‡πÄ‡∏ß‡∏•‡∏≤ ${task.time}`;
                }
                
                message += `\nüéØ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ${priorityText[task.priority]}`;
                
                if (task.dueDate) {
                    message += `\n‚è∞ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à: ${task.dueDate}`;
                }

                if (task.description) {
                    message += `\nüìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${task.description}`;
                }

                const success = await this.sendLineMessage(message);
                
                if (!success) {
                    console.warn('Failed to send LINE notification');
                }
            }

            async sendDueDateNotifications() {
                if (!this.lineNotifyEnabled) return;

                const today = new Date();
                const notificationsToSend = [];

                this.tasks.forEach(task => {
                    if (task.dueDate && task.status !== 'completed') {
                        const dueDate = new Date(task.dueDate);
                        const diffTime = dueDate - today;
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                        if (diffDays === 0) {
                            notificationsToSend.push({
                                task,
                                message: `‚ö†Ô∏è ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!\nüìã ${task.title}\nüë§ ${task.assignee || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\nüìÖ ${task.dueDate}`
                            });
                        } else if (diffDays === 1) {
                            notificationsToSend.push({
                                task,
                                message: `üîî ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ\nüìã ${task.title}\nüë§ ${task.assignee || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\nüìÖ ${task.dueDate}`
                            });
                        } else if (diffDays < 0 && Math.abs(diffDays) % 7 === 0) {
                            // Send weekly reminder for overdue tasks
                            notificationsToSend.push({
                                task,
                                message: `üö® ‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß ${Math.abs(diffDays)} ‡∏ß‡∏±‡∏ô!\nüìã ${task.title}\nüë§ ${task.assignee || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\nüìÖ ${task.dueDate}`
                            });
                        }
                    }
                });

                // Send notifications with delay to avoid rate limiting
                for (let i = 0; i < notificationsToSend.length; i++) {
                    await this.sendLineMessage(notificationsToSend[i].message);
                    if (i < notificationsToSend.length - 1) {
                        await new Promise(resolve => setTimeout(resolve, 1000)); // 1 second delay
                    }
                }
            }

            showMessage(message, type = 'info') {
                // Create toast notification
                const toast = document.createElement('div');
                toast.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
                
                switch (type) {
                    case 'success':
                        toast.classList.add('bg-green-500', 'text-white');
                        break;
                    case 'error':
                        toast.classList.add('bg-red-500', 'text-white');
                        break;
                    case 'warning':
                        toast.classList.add('bg-yellow-500', 'text-white');
                        break;
                    default:
                        toast.classList.add('bg-blue-500', 'text-white');
                }
                
                toast.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">${message}</span>
                        <button class="ml-4 text-white hover:text-gray-200" onclick="this.parentElement.parentElement.remove()">√ó</button>
                    </div>
                `;
                
                document.body.appendChild(toast);
                
                // Animate in
                setTimeout(() => {
                    toast.classList.remove('translate-x-full');
                }, 100);
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    toast.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (toast.parentElement) {
                            toast.remove();
                        }
                    }, 300);
                }, 5000);
            }
        }
        
        // Initialize the scheduler when page loads
        let scheduler;
        document.addEventListener('DOMContentLoaded', () => {
            scheduler = new TaskScheduler();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98dd817644229faa',t:'MTc2MDM0NDU0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
